import{i as P,d as v}from"./rect-DC6GBRy5.js";import{_ as S,ag as C,a7 as D,U as x,y as p,R,r as g,c as y,o as b,b as r,A as c,B as m,a as V,H as f,t as h,e as u,h as a}from"./index-Q-rLfHSZ.js";import{P as E,a as Y}from"./press-tabs-C0BgfCWC.js";import"./relation-C7hDGN8M.js";import"./touch-Djes3Zvx.js";import"./scroll-view-d6qms1vU.js";import"./press-sticky-sp8p-clS.js";import"./bind-event-DNeD-BxK.js";function L(t,e){return t>e?"horizontal":e>t?"vertical":""}const M={data(){return{direction:""}},methods:{touchStart(t){this.resetTouchStatus(),this.startX=t.touches[0].clientX,this.startY=t.touches[0].clientY},touchMove(t){const e=t.touches[0];this.deltaX=e.clientX<0?0:e.clientX-this.startX,this.deltaY=e.clientY-this.startY,this.offsetX=Math.abs(this.deltaX),this.offsetY=Math.abs(this.deltaY);const o=10;(!this.direction||this.offsetX<o&&this.offsetY<o)&&(this.direction=L(this.offsetX,this.offsetY))},resetTouchStatus(){this.direction="",this.deltaX=0,this.deltaY=0,this.offsetX=0,this.offsetY=0}}};function X(t){(typeof t.cancelable!="boolean"||t.cancelable)&&t.preventDefault()}const T=50,w=["pulling","loosing","success"],H={name:"PressPullRefresh",options:{styleIsolation:"shared"},components:{PressLoading:D},mixins:[M,C],props:{disabled:Boolean,successText:{type:String,default:""},pullingText:{type:String,default:""},loosingText:{type:String,default:""},loadingText:{type:String,default:""},pullDistance:{type:[Number,String],default:""},successDuration:{type:[Number,String],default:500},animationDuration:{type:[Number,String],default:300},headHeight:{type:[Number,String],default:T},trackStyle:{type:String,default:""},customStyle:{type:[String,Object],default:""}},emits:["change","update:modelValue","refresh"],data(){return{status:"normal",distance:0,duration:0,TEXT_STATUS:w}},computed:{wrapStyle(){return p(this.customStyle)},statusText(){const{status:t}=this;return this[`${t}Text`]||R(t)},touchable(){return this.status!=="loading"&&this.status!=="success"&&!this.disabled},innerTrackStyle(){return p([{transitionDuration:`${this.duration}ms`,transform:this.distance?`translate3d(0,${this.distance}px, 0)`:""},this.trackStyle])},headStyle(){return this.headHeight!==T?p({height:`${this.headHeight}px`}):""}},watch:{realModelValue(t){this.duration=this.animationDuration,t?this.setStatus(+this.headHeight,!0):this.successText?this.showSuccessTip():this.setStatus(0,!1)}},mounted(){this.scrollEl=v(this.$el)},methods:{checkPullStart(t){this.ceiling=!0,this.ceiling=P(this.scrollEl)===0,this.ceiling&&(this.duration=0,this.touchStart(t))},onTouchStart(t){this.touchable&&this.checkPullStart(t)},onTouchMove(t){this.touchable&&(this.ceiling||this.checkPullStart(t),this.touchMove(t),this.ceiling&&this.deltaY>=0&&this.direction==="vertical"&&(X(t),this.setStatus(this.ease(this.deltaY))))},onTouchEnd(){this.touchable&&this.ceiling&&this.deltaY&&(this.duration=this.animationDuration,this.status==="loosing"?(this.setStatus(+this.headHeight,!0),this.emitModelValue(!0),this.$emit("change",!0),x(()=>{this.$emit("refresh")})):this.setStatus(0))},ease(t){const e=+(this.pullDistance||this.headHeight);return t>e&&(t<e*2?t=e+(t-e)/2:t=e*1.5+(t-e*2)/4),Math.round(t)},setStatus(t,e){let o;e?o="loading":t===0?o="normal":o=t<(this.pullDistance||this.headHeight)?"pulling":"loosing",this.distance=t,o!==this.status&&(this.status=o),this.$emit("change",{status:this.status,distance:t})},showSuccessTip(){this.status="success",setTimeout(()=>{this.setStatus(0)},this.successDuration)}}};function N(t,e,o,_,i,s){const d=g("PressLoading");return b(),y("div",{class:"press-pull-refresh",style:m(s.wrapStyle)},[r("div",{ref:"track",class:"press-pull-refresh__track",style:m(s.innerTrackStyle),onTouchstart:e[0]||(e[0]=(...n)=>s.onTouchStart&&s.onTouchStart(...n)),onTouchmove:e[1]||(e[1]=(...n)=>s.onTouchMove&&s.onTouchMove(...n)),onTouchend:e[2]||(e[2]=(...n)=>s.onTouchEnd&&s.onTouchEnd(...n)),onTouchcancel:e[3]||(e[3]=(...n)=>s.onTouchEnd&&s.onTouchEnd(...n))},[r("div",{class:"press-pull-refresh__head",style:m(s.headStyle)},[i.status==="pulling"?c(t.$slots,"pulling",{key:0,distance:i.distance},()=>[f(h(o.pullingText),1)],!0):i.status==="loosing"?c(t.$slots,"loosing",{key:1},()=>[f(h(o.loosingText),1)],!0):i.status==="success"?c(t.$slots,"success",{key:2},()=>[f(h(o.successText),1)],!0):i.status==="normal"?c(t.$slots,"normal",{key:3},void 0,!0):i.status==="loading"?c(t.$slots,"loading",{key:4},()=>[u(d,{size:"16"},{default:a(()=>[f(h(s.statusText),1)]),_:1})],!0):V("",!0)],4),c(t.$slots,"default",{},void 0,!0)],36)],4)}const U=S(H,[["render",N],["__scopeId","data-v-c1db1e11"]]),z={i18n:{"zh-CN":{try:"下拉试试",text:"刷新次数",success:"刷新成功",successTip:"成功提示",customTips:"自定义提示"},"en-US":{try:"Try it down",text:"Refresh Count",success:"Refresh success",successTip:"Success Tip",customTips:"Custom Tips"}},components:{PressPullRefresh:U,PressTab:Y,PressTabs:E},data(){return{count:0,isLoading:!1,active:0}},computed:{tips(){return this.count?`${this.t("text")}: ${this.count}`:this.t("try")}},methods:{onRefresh(){setTimeout(()=>{this.onGTip("刷新成功"),this.isLoading=!1,this.count+=1},1e3)},onChange(t){console.log("[onChange]",t)},onChangeTab(t){console.log("[onChangeTab]",t)}}},I={class:"demo-wrap demo-pull-refresh"},A={class:"demo-button"},B={class:"demo-button"},q={class:"demo-button"};function O(t,e,o,_,i,s){const d=g("PressPullRefresh"),n=g("PressTab"),k=g("PressTabs");return b(),y("div",I,[u(k,{active:i.active,onChange:s.onChangeTab},{default:a(()=>[u(n,{title:t.t("basicUsage")},{default:a(()=>[u(d,{modelValue:i.isLoading,"onUpdate:modelValue":e[0]||(e[0]=l=>i.isLoading=l),onRefresh:s.onRefresh,onChange:s.onChange},{default:a(()=>[r("p",A,h(s.tips),1)]),_:1},8,["modelValue","onRefresh","onChange"])]),_:1},8,["title"]),u(n,{title:t.t("successTip")},{default:a(()=>[u(d,{modelValue:i.isLoading,"onUpdate:modelValue":e[1]||(e[1]=l=>i.isLoading=l),"success-text":t.t("success"),onRefresh:e[2]||(e[2]=l=>s.onRefresh(!1))},{default:a(()=>[r("p",B,h(s.tips),1)]),_:1},8,["modelValue","success-text"])]),_:1},8,["title"]),u(n,{title:t.t("customTips")},{default:a(()=>[u(d,{modelValue:i.isLoading,"onUpdate:modelValue":e[3]||(e[3]=l=>i.isLoading=l),"head-height":"80",onRefresh:e[4]||(e[4]=l=>s.onRefresh(!0))},{pulling:a(({distance:l})=>[r("img",{class:"doge",src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/7/own_mike_9ebf38f1fc4354df84.png",style:m({transform:`scale(${l/80})`})},null,4)]),loosing:a(()=>e[5]||(e[5]=[r("img",{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/7/own_mike_9ebf38f1fc4354df84.png",class:"doge"},null,-1)])),loading:a(()=>e[6]||(e[6]=[r("img",{src:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/article/2024/7/own_mike_aecbd81ffaca64b6f4.jpg",class:"doge"},null,-1)])),default:a(()=>[r("p",q,h(s.tips),1)]),_:1},8,["modelValue"])]),_:1},8,["title"])]),_:1},8,["active","onChange"])])}const $=S(z,[["render",O],["__scopeId","data-v-823ad3d7"]]);export{$ as default};
