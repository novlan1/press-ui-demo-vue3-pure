import{P as w}from"./press-cell-DQI7GKjm.js";import{P as x}from"./press-popover-Bgb7X0OA.js";import{g as d,f as B}from"./rect-7HbQQVQ8.js";import{i as L}from"./utils-6Uv3ickc.js";import{n as f}from"./add-unit-CSy-4COV.js";import{_ as b,r as l,o as h,c as u,f as c,l as _,F as k,y as N,n as P,a as y,t as v,d as A}from"./index-4prF5mFA.js";import{s as E,a as S,P as D,F as z}from"./helper-DFCphh7x.js";import{P as O}from"./press-picker-BQuw-yOi.js";import"./press-icon-plus-BKnDNWlW.js";import"./style-CpIyAjCl.js";import"./press-info-zFc1oCW_.js";import"./press-component-Cv9kTz4A.js";import"./link-pPHzr9dz.js";import"./event-CZpnkkJH.js";import"./support-passive-CNRHRm4O.js";import"./system-DmiJ0d78.js";import"./press-popup-BjrRY9bM.js";import"./press-button-BNvNLjda.js";import"./press-loading-plus-BuhRayzR.js";import"./press-loading-wKaN170k.js";import"./button-Dky8tJDD.js";import"./function-BV4CtTTe.js";import"./press-switch-Cy8l3HrA.js";import"./computed-jVh4moej.js";import"./functional-gQwSCE-6.js";import"./index-8SKntImH.js";let i=null;const H={name:"PressPagination",components:{PressPopover:x},props:{total:{type:Number,default:0},current:{type:Number,default:0},expand:{type:Boolean,default:!1},tipTemplate:{type:String,default:"第{{0}}页"},autoScroll:{type:Number,default:1},safeAreaInsetBottom:{type:Boolean,default:!0},customClass:{type:String,default:""},mode:{type:String,default:""}},options:{virtualHost:!0,styleIsolation:"shared"},emits:["change"],data(){return{innerCurrent:0,scrollToView:"",tipOffset:0,selectedEvent:!1,zonesBox:{},scrollTop:0,old:{scrollTop:0}}},computed:{pageList(){return Array.from({length:this.total}).map((e,o)=>o+1)},tipStyle(){return`top: ${this.tipOffset}px;bottom: unset;right: 50px;width: max-content;left: auto;transform: translateY(-50%);line-height: 16px;min-width: 42px;`},pageTip(){return this.tipTemplate.replace("{{0}}",this.innerCurrent)}},watch:{current:{handler(e){const o=this.pageList.findIndex(t=>t===e);this.innerCurrent=o>-1?this.pageList[o]:this.pageList[0],f(()=>{this.scrollTo()})},immediate:!0},total:{handler(){f(()=>{this.getScrollBarSize()})}},mode:{handler(){f(()=>{this.getScrollBarSize()})}}},mounted(){this.selectedEvent=!1,this.getScrollBarSize()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},updated(){f().then(()=>{this.updatePopoverTipPosition()})},methods:{onDestroyed(){this.selectedEvent=!1,i&&(clearTimeout(i),i=null)},getScrollBarSize(){d(this,".press-scrollbar").then(e=>{e&&(this.zonesBox={top:e.top,bottom:e.bottom,height:e.height})})},updatePopoverTipPosition(){d(this,`#seq-${this.innerCurrent}`).then(e=>{e&&(this.tipOffset=e.top-this.zonesBox.top+e.height/2)})},scroll(e){L()?this.old.scrollTop=e.target.scrollTop:this.old.scrollTop=e.detail.scrollTop,this.updatePopoverTipPosition()},scrollTo(){const{autoScroll:e}=this;this.scrollToView=`seq-${this.innerCurrent}`,this.scrollTop=this.old.scrollTop,Promise.all([B(this,"#zoneBox"),d(this,`#seq-${this.innerCurrent}`)]).then(([o,t])=>{if(!t)return;const{top:a,bottom:n,height:s=0}=this.zonesBox;if(s>0){if(t.top-a<e*t.height)this.scrollTop=Math.max(1,(this.innerCurrent-1-e)*t.height);else if(n-t.bottom<e*t.height){const r=(this.innerCurrent+e)*t.height-s;this.scrollTop=Math.min(r,o.scrollHeight-s)}this.updatePopoverTipPosition()}})},handleSelect(e){i&&(clearTimeout(i),i=null),this.selectedEvent=!0,this.innerCurrent!==e&&(this.innerCurrent=e,this.$emit("change",e)),this.scrollTo(),i=setTimeout(()=>{this.selectedEvent=!1},500)}}},U={key:0,class:"press-pagination__wrap"},F=["id","onClick"];function M(e,o,t,a,n,s){const r=l("scroll-view"),g=l("PressPopover");return h(),u("div",{class:P(["press-pagination",[t.customClass,{"press-pagination--safe":t.safeAreaInsetBottom},{"press-pagination--hor":t.mode==="hor"}]])},[s.pageList.length>1?(h(),u("div",U,[c(r,{id:"zoneBox",class:P(["press-scrollbar","press-scrollbar--active"]),"scroll-y":"true","scroll-with-animation":"","enable-flex":!0,"scroll-top":n.scrollTop,onScroll:s.scroll},{default:_(()=>[(h(!0),u(k,null,N(s.pageList,(p,m)=>(h(),u("div",{id:"seq-"+p,key:m,class:P(["press-scrollbar__scale",[{"press-scrollbar__scale--selected":n.innerCurrent===p},`press-scrollbar__scale--total-${t.total}`]]),onClick:T=>s.handleSelect(p,m)},[y("span",null,v(p),1)],10,F))),128))]),_:1},8,["scroll-top","onScroll"]),c(g,{show:n.selectedEvent,placement:"left","custom-style":s.tipStyle},{default:_(()=>[y("p",null,v(s.pageTip),1)]),_:1},8,["show","custom-style"])])):A("",!0)],2)}const V=b(H,[["render",M],["__scopeId","data-v-38fd60c0"]]),C={pageTotal:30,current:2,expand:!1},I=Array.from({length:4}).map((e,o)=>10**o).reduce((e,o)=>{for(let t=1;t<10;t++)e.push(o*t);return e},[]).map(e=>({label:e,value:e}));function q({context:e,callback:o,pageTotal:t,current:a,isHor:n}){E({context:e,title:"自定义设置",closeIcon:!0,cellList:[{label:"页面数",value:t,click:({context:s})=>{s.closeDialog(),S({title:"页面数",closeIcon:!0,list:I,current:{value:t},context:e}).then(({item:r})=>{C.pageTotal=r.value,e.onGTip("设置成功"),typeof o.changePageTotal=="function"&&o.changePageTotal.call(e,r.value)}).catch(()=>{})}},{label:"当前页",value:a,click:({context:s})=>{s.closeDialog(),S({title:"当前页",closeIcon:!0,list:I.filter(r=>r.value<=t),current:{value:a},context:e}).then(({item:r})=>{C.current=r.value,e.onGTip("设置成功"),typeof o.changeCurrent=="function"&&o.changeCurrent.call(e,r.value)}).catch(()=>{})}},{label:"是否为Hor模式",type:"switch",open:n,click:({context:s})=>{s.closeDialog(),e.onGTip("设置成功"),typeof o.changeHor=="function"&&o.changeHor.call(e,!n)}}]})}const G={components:{PressPagination:V,PressPopupCell:D,PressPicker:O,PressCell:w},data(){const e={...C};return{sectionStyle:"margin: 0;background: #f7f8fa;",headerStyle:"background: #f7f8fa;",FUNCTIONAL_ID_MAP:z,mode:"",componentConfig:e}},methods:{onShowBasicPopupCell(){const{pageTotal:e,current:o}=this.componentConfig;q({context:this,callback:{changePageTotal:this.changePageTotal,changeCurrent:this.changeCurrent,changeHor:this.changeHor},pageTotal:e,current:o,isHor:this.mode==="hor"})},changeExpand(e){this.componentConfig={...this.componentConfig,expand:e}},changePageTotal(e){this.componentConfig={...this.componentConfig,pageTotal:e},this.componentConfig.current>e&&(this.componentConfig.current=e)},changeCurrent(e){this.componentConfig={...this.componentConfig,current:e}},changeHor(e){this.mode=e?"hor":""},onChange(e){console.log("[onChange]",e),this.componentConfig.current=e}}},R={class:"demo-wrap demo-wrap--gray"};function K(e,o,t,a,n,s){const r=l("press-cell"),g=l("demo-block"),p=l("PressPopupCell"),m=l("PressPicker"),T=l("PressPagination");return h(),u("div",R,[c(g,{title:e.t("basicUsage"),"section-style":n.sectionStyle,"header-style":n.headerStyle},{default:_(()=>[c(r,{title:e.t("custom"),"is-link":"",onClick:s.onShowBasicPopupCell},null,8,["title","onClick"])]),_:1},8,["title","section-style","header-style"]),c(p,{id:n.FUNCTIONAL_ID_MAP.POPUP_CELL,ref:n.FUNCTIONAL_ID_MAP.POPUP_CELL,mode:"functional"},null,8,["id"]),c(m,{id:n.FUNCTIONAL_ID_MAP.PICKER,ref:n.FUNCTIONAL_ID_MAP.PICKER,mode:"functional"},null,8,["id"]),c(T,{total:n.componentConfig.pageTotal,current:n.componentConfig.current,expand:n.componentConfig.expand,mode:n.mode,onChange:s.onChange},null,8,["total","current","expand","mode","onChange"])])}const _e=b(G,[["render",K]]);export{_e as default};
