import{y as P,u as g,_,ai as f,ak as C,ae as b,G as V,c as d,o as c,b as p,a as y,n as h,B as m,A as S,P as L,T as z,r as v,e as a,h as r}from"./index-BiwYslXk.js";function B(e){return P({width:g(e.buttonSize),height:g(e.buttonSize)})}function E(e){return P({width:g(e.inputWidth),height:g(e.buttonSize)})}const I={buttonStyle:B,inputStyle:E},N=600,w=200;function k(e,t){const n=Math.pow(10,10);return Math.round((e+t)*n)/n}function T(e,t){return String(e)===String(t)}const M={name:"PressStepper",field:!0,props:{value:{type:[Number,String],default:0},integer:{type:Boolean},disabled:Boolean,inputWidth:{type:String,default:""},buttonSize:{type:String,default:""},asyncChange:Boolean,disableInput:Boolean,decimalLength:{type:Number,default:0},min:{type:Number,default:1},max:{type:Number,default:Number.MAX_SAFE_INTEGER},step:{type:Number,default:1},showPlus:{type:Boolean,default:!0},showMinus:{type:Boolean,default:!0},disablePlus:Boolean,disableMinus:Boolean,longPress:{type:Boolean,default:!0},theme:{type:String,default:""},alwaysEmbed:Boolean,customClass:{type:String,default:""},inputClass:{type:String,default:""},minusClass:{type:String,default:""},plusClass:{type:String,default:""}},emits:["focus","blur","change","overlimit","minus","plus"],data(){return{currentValue:"",focus:!1,utils:V,computed:I}},watch:{value:{handler(){this.observeValue()}},integer:{handler(){this.check()}},decimalLength:{handler(){this.check()}},min:{handler(){this.check()}},max:{handler(){this.check()}}},created(){this.currentValue=this.format(this.value)},methods:{observeValue(){const{value:e,currentValue:t}=this;T(e,t)||(this.currentValue=this.format(e))},check(){const e=this.format(this.currentValue);T(e,this.currentValue)||(this.currentValue=e)},isDisabled(e){const{disabled:t,disablePlus:n,disableMinus:o,currentValue:i,max:s,min:l}=this;return e==="plus"?t||n||i>=s:t||o||i<=l},onFocus(e){this.$emit("focus",b(e))},onBlur(e){const t=this.format(f(e));this.emitChange(t),this.$emit("blur",Object.assign(Object.assign({},b(e)),{value:t}))},filter(e){return e=String(e).replace(/[^0-9.-]/g,""),this.integer&&e.indexOf(".")!==-1&&(e=e.split(".")[0]),e},format(e){return e=this.filter(e),e=e===""?0:+e,e=Math.max(Math.min(this.max,e),this.min),C(this.decimalLength)&&(e=e.toFixed(this.decimalLength)),e},onInput(e){const t=f(e);if(t==="")return;let n=this.filter(t);if(C(this.decimalLength)&&n.indexOf(".")!==-1){const o=n.split(".");n=`${o[0]}.${o[1].slice(0,this.decimalLength)}`}this.emitChange(n)},emitChange(e){this.asyncChange||(this.currentValue=e),this.$emit("change",e)},onChange(){const{type:e}=this;if(this.isDisabled(e)){this.$emit("overlimit",e);return}const t=e==="minus"?-this.step:+this.step,n=this.format(k(+this.currentValue,t));this.emitChange(n),this.$emit(e)},longPressStep(){this.longPressTimer=setTimeout(()=>{this.onChange(),this.longPressStep()},w)},onTap(e){const{type:t}=e.currentTarget.dataset;this.type=t,this.onChange()},onTouchStart(e){if(!this.longPress)return;clearTimeout(this.longPressTimer);const{type:t}=e.currentTarget.dataset;this.type=t,this.isLongPress=!1,this.longPressTimer=setTimeout(()=>{this.isLongPress=!0,this.onChange(),this.longPressStep()},N)},onTouchEnd(){this.longPress&&clearTimeout(this.longPressTimer)}}},x={class:"press-stepper-index"},R=["type","value","focus","disabled"];function A(e,t,n,o,i,s){return c(),d("div",x,[p("div",{class:h([i.utils.bem2("stepper",[n.theme]),n.customClass])},[n.showMinus?(c(),d("div",{key:0,"data-type":"minus",style:m(""+i.computed.buttonStyle({buttonSize:n.buttonSize})),class:h([n.minusClass,i.utils.bem2("stepper__minus",{disabled:n.disabled||n.disableMinus||i.currentValue<=n.min})]),"hover-class":"press-stepper__minus--hover","hover-stay-time":"70",onClick:t[0]||(t[0]=(...l)=>s.onTap&&s.onTap(...l)),onTouchstart:t[1]||(t[1]=(...l)=>s.onTouchStart&&s.onTouchStart(...l)),onTouchend:t[2]||(t[2]=(...l)=>s.onTouchEnd&&s.onTouchEnd(...l))},[S(e.$slots,"minus",{},void 0,!0)],38)):y("",!0),p("input",{"always-embed":!1,type:n.integer?"number":"digit",class:h(n.inputClass+" "+i.utils.bem2("stepper__input",{disabled:n.disabled||n.disableInput})),style:m(""+i.computed.inputStyle({buttonSize:n.buttonSize,inputWidth:n.inputWidth})),value:i.currentValue,focus:i.focus,disabled:n.disabled||n.disableInput,onInput:t[3]||(t[3]=(...l)=>s.onInput&&s.onInput(...l)),onFocus:t[4]||(t[4]=(...l)=>s.onFocus&&s.onFocus(...l)),onBlur:t[5]||(t[5]=(...l)=>s.onBlur&&s.onBlur(...l))},null,46,R),n.showPlus?(c(),d("div",{key:1,"data-type":"plus",style:m(""+i.computed.buttonStyle({buttonSize:n.buttonSize})),class:h(n.plusClass+" "+i.utils.bem2("stepper__plus",{disabled:n.disabled||n.disablePlus||i.currentValue>=n.max})),"hover-class":"press-stepper__plus--hover","hover-stay-time":"70",onClick:t[6]||(t[6]=(...l)=>s.onTap&&s.onTap(...l)),onTouchstart:t[7]||(t[7]=(...l)=>s.onTouchStart&&s.onTouchStart(...l)),onTouchend:t[8]||(t[8]=(...l)=>s.onTouchEnd&&s.onTouchEnd(...l))},[S(e.$slots,"plus",{},void 0,!0)],38)):y("",!0)],2)])}const D=_(M,[["render",A],["__scopeId","data-v-06f9ad90"]]),F={i18n:{"zh-CN":{step:"步长设置",range:"限制输入范围",integer:"限制输入整数",roundTheme:"圆角风格",asyncChange:"异步变更",customSize:"自定义大小",disableInput:"禁用输入框",decimalLength:"固定小数位数",closeLongPress:"关闭长按"},"en-US":{step:"Step",range:"Range",integer:"Integer",roundTheme:"Round Theme",asyncChange:"Async Change",customSize:"Custom Size",disableInput:"Disable Input",decimalLength:"Decimal Length",closeLongPress:"Close Long Press"}},components:{PressStepper:D,PressToast:z,PressCell:L},data(){return{value:1,asyncValue:1}},methods:{onChange(e){console.log("onChange.val",e)},onSyncChange(e){this.$toast.loading({duration:1e3}),setTimeout(()=>{console.log("onSyncChange.val",e),this.asyncValue=e},1e3)}}},O={class:"demo-wrap"};function G(e,t,n,o,i,s){const l=v("PressStepper"),u=v("PressCell");return c(),d("div",O,[a(u,{title:e.t("basicUsage")},{default:r(()=>[a(l,{value:i.value,onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("step")},{default:r(()=>[a(l,{value:i.value,step:2,onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("range")},{default:r(()=>[a(l,{value:i.value,min:5,max:8,onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("integer")},{default:r(()=>[a(l,{value:i.value,integer:"",onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("disabled")},{default:r(()=>[a(l,{disabled:"",value:i.value,onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("closeLongPress")},{default:r(()=>[a(l,{"long-press":!1,value:i.value,onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("decimalLength")},{default:r(()=>[a(l,{step:.2,"decimal-length":1,value:i.value,onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("asyncChange")},{default:r(()=>[a(l,{"async-change":"",value:i.asyncValue,onChange:s.onSyncChange},null,8,["value","onChange"])]),_:1},8,["title"]),a(u,{title:e.t("customSize")},{default:r(()=>[a(l,{"input-width":"40px","button-size":"32px",value:i.value,onChange:s.onChange},null,8,["value","onChange"])]),_:1},8,["title"])])}const U=_(F,[["render",G]]);export{U as default};
