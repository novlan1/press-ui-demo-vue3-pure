import{P as D}from"./press-info-BWsAQQHi.js";import{P as $}from"./press-sticky-D4FnAbAT.js";import{t as R}from"./touch-Djes3Zvx.js";import{r as x,d as L}from"./system-BAdrsxg_.js";import{b as _,g as k}from"./rect-ZZRvyvMD.js";import{a as N,n as C}from"./validator-OjQp2SYe.js";import{P as W,C as H}from"./relation-Cl7c7lz0.js";import{s as b,u as p}from"./utils-Do31p4kb.js";import{d as B,a as z}from"./press-component-HD2axD72.js";import{g as h}from"./parent-map-CSroF5oj.js";import{_ as A,r as S,o as m,c as g,f as I,n as P,a as y,x as a,y as v,v as f,d as w,F as O,i as V,u as M,t as X,b as F}from"./index-BZexHo5h.js";function U(e,t){const s=["tab-class"];return e&&s.push("tab-active-class"),t&&s.push("press-ellipsis"),s.join(" ")}function j(e){const t=e.active?e.titleActiveColor:e.titleInactiveColor,s=e.scrollable&&e.ellipsis;return e.type==="card"?b({"border-color":e.color,"background-color":!e.disabled&&e.active?e.color:null,color:t||(!e.disabled&&!e.active?e.color:null),"flex-basis":s?`${88/e.swipeThreshold}%`:null}):b({color:t,"flex-basis":s?`${88/e.swipeThreshold}%`:null})}function K(e,t){return b({"border-color":t==="card"&&e?e:null})}function q(e){return e.animated?b({left:`${-100*e.currentIndex}%`,"transition-duration":`${e.duration}s`,"-webkit-transition-duration":`${e.duration}s`}):""}function G(e){const t=p.addUnit(e.lineWidth);return b({width:t,transform:`translateX(${e.lineOffsetLeft}px)`,"-webkit-transform":`translateX(${e.lineOffsetLeft}px)`,"background-color":e.color,height:e.lineHeight!==-1?p.addUnit(e.lineHeight):null,"border-radius":e.lineHeight!==-1?p.addUnit(e.lineHeight):null,"transition-duration":e.skipTransition?null:`${e.duration}s`,"-webkit-transition-duration":e.skipTransition?null:`${e.duration}s`})}const T={tabClass:U,tabStyle:j,trackStyle:q,lineStyle:G,navStyle:K},J={name:"PressTabs",options:{...B,styleIsolation:"shared"},components:{PressInfo:D,PressSticky:$},mixins:[R,W(h)],props:{...z,navClass:{type:String,default:""},tabClass:{type:String,default:""},tabActiveClass:{type:String,default:""},lineClass:{type:String,default:""},sticky:{type:Boolean,default:!1},border:{type:Boolean,default:!1},swipeable:{type:Boolean,default:!1},titleActiveColor:{type:String,default:""},titleInactiveColor:{type:String,default:""},color:{type:String,default:""},animated:{type:Boolean,default:!1},lineWidth:{type:[Number,String,null],default:40},lineHeight:{type:[Number,String,null],default:-1},active:{type:[Number,String,null],default:0},type:{type:String,default:"line"},ellipsis:{type:Boolean,default:!0},duration:{type:Number,default:.3},zIndex:{type:Number,default:1},swipeThreshold:{type:Number,default:5},offsetTop:{type:Number,default:0},lazyRender:{type:Boolean,default:!0},extraClassPrefix:{type:String,default:""},mode:{type:String,default:""}},emits:["scroll","disabled","click","input","change"],data(){return{tabs:[],scrollLeft:0,scrollable:!1,currentIndex:0,container:null,skipTransition:!0,scrollWithAnimation:!1,lineOffsetLeft:0,computed:T,utils:p}},computed:{tabsClass(){const{type:e,customClass:t,mode:s}=this,l=s==="hor",r=s==="e-sport";return`${this.bem3("tabs",[e,{hor:l,"e-sport":r}])} ${t}`},tabsWrapClass(){const{scrollable:e,type:t,border:s}=this;return`${this.bem3("tabs__wrap",{scrollable:e})} ${t==="line"&&s?this.bem3("hairline--top-bottom"):""}`},tabScrollClass(){const{type:e}=this;return this.bem3("tabs__scroll",[e])},theNavClass(){const{type:e,ellipsis:t,navClass:s}=this,l=`${s} nav-class`;return`${this.bem3("tabs__nav",[e,{complete:!t}])} ${l}`},navStyle(){const{color:e,type:t}=this;return T.navStyle(e,t)},lineStyle(){const{color:e,lineOffsetLeft:t,lineHeight:s,skipTransition:l,duration:r,lineWidth:i}=this;return T.lineStyle({color:e,lineOffsetLeft:t,lineHeight:s,skipTransition:l,duration:r,lineWidth:i})},trackClass(){const{animated:e}=this;return`${this.bem3("tabs__track",[{animated:e}])}`},trackStyle(){const{duration:e,currentIndex:t,animated:s}=this;return T.trackStyle({duration:e,currentIndex:t,animated:s})},realEllipsis(){return this.scrollable&&this.ellipsis}},watch:{animated:{handler(){this.children.forEach((e,t)=>e.updateRender(t===this.currentIndex,this))}},lineWidth:{handler(){this.resize()}},active:{handler(e){e!==this.getCurrentName()&&this.setCurrentIndexByName(e)}},swipeThreshold:{handler(e){this.setData({scrollable:this.children.length>e||!this.ellipsis})}}},created(){this.children=[]},mounted(){x(()=>{this.swiping=!0,this.container=()=>this.$refs.pressTabs,this.updateTabs(),this.resize(),this.scrollIntoView()}),this.$nextTick(()=>{this.resize()})},methods:{bem3(e,t){return p.bem3(e,t,this.extraClassPrefix)},getTabClass(e,t){const{currentIndex:s,ellipsis:l,tabClass:r,tabActiveClass:i}=this,o=`${i} tab-active-class`,c=`${r} tab-class`;return`${this.bem3("tab",{active:t===s,disabled:e.disabled,complete:!l})} ${this.bem3("ellipsis")} ${c} ${t===s?o:""}`},getTabStyle(e,t){const{type:s,color:l,active:r,currentIndex:i,realEllipsis:o,titleActiveColor:c,titleInactiveColor:d,swipeThreshold:n}=this,u=o?`${88/n}%`:null;return s==="card"?b({borderColor:l,backgroundColor:!e.disabled&&r?l:null,color:(t===i?c:d)||(!e.disabled&&!r?l:null),flexBasis:u}):b({color:t===i?c:d,flexBasis:u})},setData(e){Object.keys(e).forEach(t=>{this[t]=e[t]})},updateTabs(){const{children:e=[]}=this;this.tabs=e.map(t=>({title:t.title,index:t.index,disabled:t.disabled,info:t.info,dot:t.dot,titleStyle:t.titleStyle})),this.scrollable=e.length>this.swipeThreshold||!this.ellipsis,this.setCurrentIndexByName(this.active||this.getCurrentName())},trigger(e,t){const{currentIndex:s}=this,l=t||this.children[s];N(l)&&this.$emit(e,{index:l.index,name:l.getComputedName(),title:l.title})},onTap(e){const t=+e.currentTarget.dataset.index,s=this.children[t];s.disabled?this.trigger("disabled",s):(this.setCurrentIndex(t),C(()=>{this.trigger("click")}))},setCurrentIndexByName(e){const{children:t=[]}=this,s=t.filter(l=>l.getComputedName()===e);s.length&&this.setCurrentIndex(s[0].index)},setCurrentIndex(e){const{children:t=[]}=this;if(!N(e)||e>=t.length||e<0||(L(this,()=>{t.forEach((l,r)=>{const i=r===e;(i!==l.active||!l.initialled)&&l.updateRender(i,this)})}),e===this.currentIndex))return;const s=this.currentIndex!==null;this.setData({currentIndex:e}),x(()=>{this.resize(),this.scrollIntoView()}),C(()=>{this.trigger("input"),s&&this.trigger("change")})},getCurrentName(){const e=this.children[this.currentIndex];if(e)return e.getComputedName()},resize(){if(this.type!=="line")return;const{currentIndex:e,ellipsis:t,skipTransition:s}=this;Promise.all([_(this,".press-tab"),k(this,".press-tabs__line")]).then(([l=[],r])=>{const i=l[e];if(i==null)return;let o=l.slice(0,e).reduce((c,d)=>c+d.width,0);o+=(i.width-r.width)/2+(t?0:8),this.setData({lineOffsetLeft:o}),this.swiping=!0,s&&C(()=>{this.setData({skipTransition:!1})})}).catch(l=>{console.log("err",l)})},scrollIntoView(){const{currentIndex:e,scrollable:t,scrollWithAnimation:s}=this;t&&Promise.all([_(this,".press-tab"),k(this,".press-tabs__nav")]).then(([l,r])=>{const i=l[e],o=l.slice(0,e).reduce((c,d)=>c+d.width,0);this.setData({scrollLeft:o-(r.width-i.width)/2}),s||C(()=>{this.setData({scrollWithAnimation:!0})})}).catch(l=>{console.log("error",l)})},onTouchScroll(e){this.$emit("scroll",e)},onTouchStart(e){this.swipeable&&(this.swiping=!0,this.touchStart(e))},onTouchMove(e){!this.swipeable||!this.swiping||this.touchMove(e)},onTouchEnd(){if(!this.swipeable||!this.swiping)return;const{direction:e,deltaX:t,offsetX:s}=this;if(e==="horizontal"&&s>=50){const r=this.getAvailableTab(t);r!==-1&&this.setCurrentIndex(r)}this.swiping=!1},getAvailableTab(e){const{tabs:t,currentIndex:s}=this,l=e>0?-1:1;for(let r=l;s+r<t.length&&s+r>=0;r+=l){const i=s+r;if(i>=0&&i<t.length&&t[i]&&!t[i].disabled)return i}return-1},getTabKey(e,t){return`${e.title||""} - ${t} -${e.index}`}}},Q=["data-index"];function Y(e,t,s,l,r,i){const o=S("press-info"),c=S("scroll-view"),d=S("press-sticky");return m(),g("div",{ref:"pressTabs",class:a(i.tabsClass)},[I(d,{disabled:!s.sticky,"z-index":s.zIndex,"offset-top":s.offsetTop,container:r.container,onScroll:i.onTouchScroll},{default:P(()=>[y("div",{class:a(i.tabsWrapClass)},[v(e.$slots,"nav-left",{},void 0,!0),I(c,{"scroll-x":r.scrollable,"scroll-with-animation":r.scrollWithAnimation,"scroll-left":r.scrollLeft,class:a(i.tabScrollClass),style:f(s.color?"border-color: "+s.color:"")},{default:P(()=>[y("div",{class:a(i.theNavClass),style:f(i.navStyle)},[s.type==="line"?(m(),g("div",{key:0,class:a([`${i.bem3("tabs__line")} ${s.lineClass}`]),style:f(i.lineStyle)},null,6)):w("",!0),(m(!0),g(O,null,V(r.tabs,(n,u)=>(m(),g("div",{key:i.getTabKey(n,u),"data-index":u,class:a([`${i.getTabClass(n,u)}`]),style:f([`${i.getTabStyle(n,u)}`]),onClick:t[0]||(t[0]=(...E)=>i.onTap&&i.onTap(...E))},[y("div",{class:a([`${i.bem3("tab__text")}`,s.ellipsis?"press-ellipsis":""]),style:f(n.titleStyle)},[M(X(n.title)+" ",1),n.info!==null||n.dot?(m(),F(o,{key:0,info:n.info,dot:n.dot,"custom-class":"press-tab__title__info"},null,8,["info","dot"])):w("",!0)],6)],14,Q))),128))],6)]),_:1},8,["scroll-x","scroll-with-animation","scroll-left","class","style"]),v(e.$slots,"nav-right",{},void 0,!0)],2)]),_:3},8,["disabled","z-index","offset-top","container","onScroll"]),y("div",{class:a([`${i.bem3("tabs__content")}`]),onTouchstart:t[1]||(t[1]=(...n)=>i.onTouchStart&&i.onTouchStart(...n)),onTouchmove:t[2]||(t[2]=(...n)=>i.onTouchMove&&i.onTouchMove(...n)),onTouchend:t[3]||(t[3]=(...n)=>i.onTouchEnd&&i.onTouchEnd(...n)),onTouchcancel:t[4]||(t[4]=(...n)=>i.onTouchEnd&&i.onTouchEnd(...n))},[y("div",{class:a(i.trackClass),style:f(i.trackStyle)},[v(e.$slots,"default",{},void 0,!0)],6)],34)],2)}const he=A(J,[["render",Y],["__scopeId","data-v-9865a5e0"]]),Z={name:"PressTab",mixins:[H(h)],options:{...B,styleIsolation:"shared"},props:{...z,dot:{type:Boolean,default:!1},info:{type:[String,Number,null],default:""},title:{type:[String,Number,null],default:""},disabled:{type:Boolean,default:!1},titleStyle:{type:String,default:""},name:{type:[String,Number,null],default:""},extraClassPrefix:{type:String,default:""},sortIndex:{type:Number,default:0}},emits:[],data(){return{active:!1,shouldShow:!1,shouldRender:!1,initialled:!1,utils:p}},computed:{tabClass(){const{active:e,customClass:t=""}=this;return`${this.bem3("tab__pane",{active:e,inactive:!e})} ${t}`}},watch:{dot:{handler(){this.update()}},info:{handler(){this.update()}},title:{handler(){this.update()}},disabled:{handler(){this.update()}},titleStyle:{handler(){this.update()}}},created(){},mounted(){this.update()},methods:{bem3(e,t){return p.bem3(e,t,this.extraClassPrefix)},getComputedName(){return this.name!==""?this.name:this.index},updateRender(e,t){this.initialled=this.initialled||e,this.active=e,this.shouldRender=this.initialled||!t.lazyRender,this.shouldShow=e||t.animated},update(){this[h]&&(this[h].updateTabs(),x(()=>{this[h].resize()}))},destroyCallback(){this[h].updateTabs(),this.$nextTick(()=>{this[h].resize()})}}};function ee(e,t,s,l,r,i){return m(),g("div",{class:a([i.bem3("tab__pane-wrapper")])},[y("div",{class:a(i.tabClass),style:f(r.shouldShow?"":"display: none;")},[r.shouldRender?v(e.$slots,"default",{key:0}):w("",!0)],6)],2)}const fe=A(Z,[["render",ee]]);export{he as P,fe as a};
