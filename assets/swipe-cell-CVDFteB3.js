import{P as _,a as b}from"./handler-JS1HGcIE.js";import{_ as y,k as D,l as S,c as h,o as p,b as r,a as g,A as u,w as C,n as w,B as T,r as k,e as d,h as l,t as c}from"./index-D8fxni52.js";import{r as M}from"./number-CU9l-NjU.js";import{t as O}from"./touch-Djes3Zvx.js";import"./index-CyMUkfJH.js";import"./handler-helper-BKr0zvNe.js";import"./color-DciZLlTH.js";import"./press-popup-BhsK3ILH.js";const v=.3;let f=[];const W={name:"PressSwipeCell",options:{...S},mixins:[O],props:{disabled:{type:Boolean,default:!1},leftWidth:{type:Number,default:0},rightWidth:{type:Number,default:0},asyncClose:{type:Boolean,default:!1},name:{type:String,default:""},...D},emits:["click","open","close"],data(){return{catchMove:!1,wrapperStyle:"",offset:0}},watch:{leftWidth:{handler(e=0){this.offset>0&&this.swipeMove(e)}},rightWidth:{handler(e=0){this.offset<0&&this.swipeMove(-e)}}},created(){this.offset=0,f.push(this)},destroyed(){f=f.filter(e=>e!==this)},methods:{setData(e){Object.keys(e).forEach(t=>{this[t]=e[t]})},open(e){const{leftWidth:t,rightWidth:i}=this,n=e==="left"?t:-i;this.swipeMove(n),this.$emit("open",{position:e,name:this.name})},close(){this.swipeMove(0)},swipeMove(e=0){this.offset=M(e,-this.rightWidth,this.leftWidth);const t=`translate3d(${this.offset}px, 0, 0)`,i=this.dragging?"none":"transform .6s cubic-bezier(0.18, 0.89, 0.32, 1)";this.setData({wrapperStyle:`
        -webkit-transform: ${t};
        -webkit-transition: ${i};
        transform: ${t};
        transition: ${i};
      `})},swipeLeaveTransition(){const{leftWidth:e,rightWidth:t}=this,{offset:i}=this;t>0&&-i>t*v?this.open("right"):e>0&&i>e*v?this.open("left"):this.swipeMove(0),this.setData({catchMove:!1})},startDrag(e){this.disabled||(this.startOffset=this.offset,this.touchStart(e))},noop(){},onDrag(e){this.disabled||(this.touchMove(e),this.direction==="horizontal"&&(this.dragging=!0,f.filter(t=>t!==this&&t.offset!==0).forEach(t=>t.close()),this.setData({catchMove:!0}),this.swipeMove(this.startOffset+this.deltaX)))},endDrag(){this.disabled||(this.dragging=!1,this.swipeLeaveTransition())},onClick(e){const{key:t="outside"}=e.currentTarget.dataset;this.$emit("click",t),this.offset&&(this.asyncClose?this.$emit("close",{position:t,name:this.name,instance:this}):this.swipeMove(0))}}};function A(e,t,i,n,a,s){return p(),h("div",{class:w(["press-swipe-cell",e.customClass]),"data-key":"cell",onClick:t[2]||(t[2]=C((...o)=>s.onClick&&s.onClick(...o),["stop","prevent"])),onTouchstart:t[3]||(t[3]=(...o)=>s.startDrag&&s.startDrag(...o)),onTouchmoveCapture:t[4]||(t[4]=(...o)=>s.onDrag&&s.onDrag(...o)),onTouchend:t[5]||(t[5]=(...o)=>s.endDrag&&s.endDrag(...o)),onTouchcancel:t[6]||(t[6]=(...o)=>s.endDrag&&s.endDrag(...o))},[r("div",{style:T(a.wrapperStyle),class:w(["press-swipe-cell__content",a.offset?"press-swipe-cell__content--moved":""])},[i.leftWidth?(p(),h("div",{key:0,class:"press-swipe-cell__left","data-key":"left",onClick:t[0]||(t[0]=C((...o)=>s.onClick&&s.onClick(...o),["stop","prevent"]))},[u(e.$slots,"left",{},void 0,!0)])):g("",!0),u(e.$slots,"default",{},void 0,!0),i.rightWidth?(p(),h("div",{key:1,class:"press-swipe-cell__right","data-key":"right",onClick:t[1]||(t[1]=C((...o)=>s.onClick&&s.onClick(...o),["stop","prevent"]))},[u(e.$slots,"right",{},void 0,!0)])):g("",!0)],6)],34)}const B=y(W,[["render",A],["__scopeId","data-v-e004af41"]]),P={i18n:{"zh-CN":{select:"选择",delete:"删除",collect:"收藏",title:"单元格",confirm:"确定删除吗？",cardTitle:"商品标题",beforeClose:"异步关闭",customContent:"自定义内容"},"en-US":{select:"Select",delete:"Delete",collect:"Collect",title:"Cell",confirm:"Are you sure to delete?",cardTitle:"Title",beforeClose:"Before Close",customContent:"Custom Content"}},components:{PressSwipeCell:B,PressDialog:_},data(){return{asyncClose:!1}},methods:{onClick(e){console.log("onClick.val",e),this.onGTip(`click ${e}`)},onClose(...e){console.log("onClose.args",e),this.onGTip("close")},onOpen(e){console.log("onOpen.detail",e),this.onGTip(`[open] position: ${e.position}`)},onAsyncClose(e){console.log("onAsyncClose.detail",e);const t=()=>{n==null||n.close()},{position:i,instance:n}=e;switch(i){case"left":case"cell":t();break;case"right":b({context:this,title:"确定删除吗？"}).then(()=>{console.log("close"),t()}).catch(a=>{console.log("err",a)});break}}}},N={class:"demo-wrap"},z={class:"left"},E={class:"content"},G={class:"right"},L={class:"left"},R={class:"content"},V={class:"right"};function H(e,t,i,n,a,s){const o=k("PressSwipeCell"),m=k("demo-block");return p(),h("div",N,[d(m,{title:e.t("basicUsage"),"section-style":"margin:0;"},{default:l(()=>[d(o,{"right-width":65,"left-width":65,"async-close":a.asyncClose,onClick:s.onClick,onClose:s.onClose,onOpen:s.onOpen},{left:l(()=>[r("div",z,c(e.t("select")),1)]),right:l(()=>[r("div",G,c(e.t("delete")),1)]),default:l(()=>[r("div",E,c(e.t("content")),1)]),_:1},8,["async-close","onClick","onClose","onOpen"])]),_:1},8,["title"]),d(m,{title:e.t("beforeClose"),"section-style":"margin:0;"},{default:l(()=>[d(o,{ref:"asyncSwipeCell","right-width":65,"left-width":65,"async-close":!0,onClick:s.onClick,onClose:s.onAsyncClose,onOpen:s.onOpen},{left:l(()=>[r("div",L,c(e.t("select")),1)]),right:l(()=>[r("div",V,c(e.t("delete")),1)]),default:l(()=>[r("div",R,c(e.t("content")),1)]),_:1},8,["onClick","onClose","onOpen"])]),_:1},8,["title"])])}const K=y(P,[["render",H],["__scopeId","data-v-b29031e3"]]);export{K as default};
