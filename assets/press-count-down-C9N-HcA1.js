import{p as a,a as c,i as d}from"./utils-CTBTM213.js";import{_ as u,c as o,o as r,A as l,F as f,H as p,t as n,b as T}from"./index-CCB1KbBH.js";function m(t){return setTimeout(t,30)}const k={name:"PressCountDown",props:{useSlot:Boolean,millisecond:Boolean,time:{type:Number,default:0},format:{type:String,default:"HH:mm:ss"},autoStart:{type:Boolean,default:!0}},emits:["change","finish"],data(){return{formattedTime:"0",remain:0}},computed:{timeData(){return a(this.remain)}},watch:{time:{handler(t){const{remain:e,millisecond:i}=this;!i&&(Math.floor(t/1e3)===Math.floor(e/1e3)||Math.round(t/1e3)===Math.round(e/1e3))||this.reset()},immediate:!0}},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},methods:{onDestroyed(){clearTimeout(this.tid),this.tid=null},start(){this.counting||(this.counting=!0,this.endTime=Date.now()+this.remain,this.tick())},pause(){this.counting=!1,clearTimeout(this.tid)},reset(){this.pause(),this.remain=this.time,this.setRemain(this.remain),this.autoStart&&this.start()},tick(){this.millisecond?this.microTick():this.macroTick()},microTick(){this.tid=m(()=>{this.setRemain(this.getRemain()),this.remain!==0&&this.microTick()})},macroTick(){this.tid=m(()=>{const t=this.getRemain();(!d(t,this.remain)||t===0)&&this.setRemain(t),this.remain!==0&&this.macroTick()})},getRemain(){return Math.max(this.endTime-Date.now(),0)},setRemain(t){this.remain=t;const e=a(t);this.useSlot&&this.$emit("change",e),this.formattedTime=c(this.format,e),t===0&&(this.pause(),this.$emit("finish"))}}},D={class:"press-count-down"};function _(t,e,i,g,s,h){return r(),o("div",D,[i.useSlot?l(t.$slots,"default",{key:0,timeData:h.timeData},()=>[T("span",null,n(s.formattedTime),1)],!0):(r(),o(f,{key:1},[p(n(s.formattedTime),1)],64))])}const R=u(k,[["render",_],["__scopeId","data-v-5d5b77ec"]]);export{R as P};
