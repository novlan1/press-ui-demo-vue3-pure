import{_ as c,O as v,c as b,o as B,A as x,B as P,Q as I,r as p,e as l,h as o,b as m,H as g,t as _}from"./index-D8fxni52.js";function f(e,t,a){return e[t]=a,e}const S="press-barrage__item";let y=0;const V={name:"PressBarrage",mixins:[v({type:[Array],defaultValue:()=>[]})],props:{autoPlay:{type:Boolean,default:!0},rows:{type:[Number,String],default:4},top:{type:[Number,String],default:10},duration:{type:[Number,String],default:4e3},delay:{type:Number,default:300},itemHeight:{type:Number,default:26}},data(){return{isInitBarrage:!0,barrageItems:[],isPlay:!1,total:0,barrageStyle:"",barrageId:""}},computed:{},watch:{realModelValue:{handler(e,t){this.updateBarrages(e,t)},deep:!0}},mounted(){y+=1,this.barrageId=`press-barrage-${y}`,setTimeout(()=>{this.init()})},methods:{init(){const e=()=>{setTimeout(()=>{this.updateBarrages(this.realModelValue,[])})},{offsetWidth:t}=this.$refs.barrageWrapper;this.barrageStyle=`--move-distance: -${t}px`,e()},play(){this.isPlay=!0,this.barrageItems.forEach(e=>{e.style.animationPlayState="running"})},pause(){this.isPlay=!1,this.barrageItems.forEach(e=>{e.style.animationPlayState="paused"})},createBarrageItem(e,t=this.delay){let a={};return a=document.createElement("span"),a.style.animationDuration=`${this.duration}ms`,a.style.animationDelay=`${t}ms`,a.style.animationTimingFunction="linear",a.className=S,a.innerText=String(e),a},appendBarrageItem({id:e,text:t},a){var d;const i=this.createBarrageItem(t,this.isInitBarrage?a*this.delay:void 0);!this.autoPlay&&this.isPlay===!1&&(i.style.animationPlayState="paused"),(d=this.$refs.barrageWrapper)==null||d.append(i),this.total+=1;let s=this.itemHeight;s=i.offsetHeight;const r=(this.total-1)%+this.rows*s+ +this.top;i.style.top=`${r}px`,i.id=String(e),this.barrageItems.push(i),i.addEventListener("animationend",()=>{this.emitModelValue([...this.realModelValue].filter(n=>String(n.id)!==i.id))})},animationend(e){this.emitModelValue([...this.realModelValue].filter(t=>String(t.id)!==e.id))},updateBarrages(e,t){const a=new Map(t.map(i=>[i.id,i]));e.forEach((i,s)=>{a.has(i.id)?a.delete(i.id):this.appendBarrageItem(i,s)}),a.forEach(i=>{const s=this.barrageItems.findIndex(r=>r.id===String(i.id));s>-1&&(this.barrageItems[s].remove(),this.barrageItems.splice(s,1))}),this.isInitBarrage=!1}}},w=["id"];function k(e,t,a,i,s,r){return B(),b("div",{id:s.barrageId,ref:"barrageWrapper",class:"press-barrage",style:P(s.barrageStyle)},[x(e.$slots,"default",{},void 0,!0)],12,w)}const M=c(V,[["render",k],["__scopeId","data-v-a23d9190"]]),N={i18n:{"zh-CN":{barrage:"弹幕",play:"开始",pause:"暂停",videoBarrage:"模仿视频弹幕",lightweight:"轻量",customizable:"可定制的",mobile:"移动端",library:"组件库"},"en-US":{barrage:"barrage",play:"play",pause:"pause",videoBarrage:"Imitate video barrage",lightweight:"Lightweight",customizable:"Customizable",mobile:"Mobile",library:"Library"}},components:{PressBarrage:M,PressButton:I},data(){const e=[{id:100,text:this.t("lightweight")},{id:101,text:this.t("customizable")},{id:102,text:this.t("mobile")},{id:103,text:"Vue"},{id:104,text:this.t("library")},{id:105,text:"PressUI"},{id:106,text:"666"}];return{list:e,videoList:[...e],isPlay:!1}},watch:{isPlay:{handler(e){var t,a;e?(t=this.$refs.pressBarrage)==null||t.play():(a=this.$refs.pressBarrage)==null||a.pause()}}},methods:{add(){f(this,"list",[...this.list,{id:Math.random(),text:"Barrage"}])},videoAdd(){f(this,"videoList",[...this.videoList,{id:Math.random(),text:"Barrage"}])},toggle(){this.isPlay=!this.isPlay}}},C={class:"demo-wrap"};function $(e,t,a,i,s,r){const d=p("PressBarrage"),n=p("PressButton"),h=p("demo-block");return B(),b("div",C,[l(h,{title:e.t("basicUsage")},{default:o(()=>[l(d,{modelValue:s.list,"onUpdate:modelValue":t[0]||(t[0]=u=>s.list=u)},{default:o(()=>t[2]||(t[2]=[m("div",{class:"video",style:{width:"100%",height:"150px",background:"#f2f3f5"}},null,-1)])),_:1},8,["modelValue"]),l(n,{type:"primary",size:"small","custom-style":"margin-top: 10px;",onClick:r.add},{default:o(()=>t[3]||(t[3]=[g(" 弹幕 ")])),_:1},8,["onClick"])]),_:1},8,["title"]),l(h,{title:e.t("videoBarrage")},{default:o(()=>[l(d,{ref:"pressBarrage",modelValue:s.videoList,"onUpdate:modelValue":t[1]||(t[1]=u=>s.videoList=u),"auto-play":!1},{default:o(()=>t[4]||(t[4]=[m("div",{class:"video",style:{width:"100%",height:"150px",background:"#f2f3f5"}},null,-1)])),_:1},8,["modelValue"]),m("div",null,[l(n,{type:"primary",size:"small",disabled:!s.isPlay,"custom-style":"margin-top: 10px;margin-right: 10px;",onClick:r.videoAdd},{default:o(()=>t[5]||(t[5]=[g(" 弹幕 ")])),_:1},8,["disabled","onClick"]),l(n,{type:"default",size:"small","custom-style":"margin-top: 10px;",onClick:r.toggle},{default:o(()=>[g(_(s.isPlay?e.t("pause"):e.t("play")),1)]),_:1},8,["onClick"])])]),_:1},8,["title"])])}const L=c(N,[["render",$]]);export{L as default};
