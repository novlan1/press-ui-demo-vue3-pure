import{_ as y,M as B,o as c,c as b,h as v,l as x,N as P,e as l,k as o,r as p,a as m,G as g,t as I}from"./index-DccXyPO9.js";const _="press-barrage__item";let f=0;const S={name:"PressBarrage",mixins:[B({type:[Array],defaultValue:()=>[]})],props:{autoPlay:{type:Boolean,default:!0},rows:{type:[Number,String],default:4},top:{type:[Number,String],default:10},duration:{type:[Number,String],default:4e3},delay:{type:Number,default:300},itemHeight:{type:Number,default:26}},data(){return{isInitBarrage:!0,barrageItems:[],isPlay:!1,total:0,barrageStyle:"",barrageId:""}},computed:{},watch:{realModelValue:{handler(t,e){this.updateBarrages(t,e)},deep:!0}},mounted(){f+=1,this.barrageId=`press-barrage-${f}`,setTimeout(()=>{this.init()})},methods:{init(){const t=()=>{setTimeout(()=>{this.updateBarrages(this.realModelValue,[])})},{offsetWidth:e}=this.$refs.barrageWrapper;this.barrageStyle=`--move-distance: -${e}px`,t()},play(){this.isPlay=!0,this.barrageItems.forEach(t=>{t.style.animationPlayState="running"})},pause(){this.isPlay=!1,this.barrageItems.forEach(t=>{t.style.animationPlayState="paused"})},createBarrageItem(t,e=this.delay){let s={};return s=document.createElement("span"),s.style.animationDuration=`${this.duration}ms`,s.style.animationDelay=`${e}ms`,s.style.animationTimingFunction="linear",s.className=_,s.innerText=String(t),s},appendBarrageItem({id:t,text:e},s){var d;const a=this.createBarrageItem(e,this.isInitBarrage?s*this.delay:void 0);!this.autoPlay&&this.isPlay===!1&&(a.style.animationPlayState="paused"),(d=this.$refs.barrageWrapper)==null||d.append(a),this.total+=1;let i=this.itemHeight;i=a.offsetHeight;const r=(this.total-1)%+this.rows*i+ +this.top;a.style.top=`${r}px`,a.id=String(t),this.barrageItems.push(a),a.addEventListener("animationend",()=>{this.emitModelValue([...this.realModelValue].filter(n=>String(n.id)!==a.id))})},animationend(t){this.emitModelValue([...this.realModelValue].filter(e=>String(e.id)!==t.id))},updateBarrages(t,e){const s=new Map(e.map(a=>[a.id,a]));t.forEach((a,i)=>{s.has(a.id)?s.delete(a.id):this.appendBarrageItem(a,i)}),s.forEach(a=>{const i=this.barrageItems.findIndex(r=>r.id===String(a.id));i>-1&&(this.barrageItems[i].remove(),this.barrageItems.splice(i,1))}),this.isInitBarrage=!1}}},V=["id"];function k(t,e,s,a,i,r){return c(),b("div",{id:i.barrageId,ref:"barrageWrapper",class:"press-barrage",style:x(i.barrageStyle)},[v(t.$slots,"default",{},void 0,!0)],12,V)}const w=y(S,[["render",k],["__scopeId","data-v-38f1fbc1"]]),M={i18n:{"zh-CN":{barrage:"弹幕",play:"开始",pause:"暂停",videoBarrage:"模仿视频弹幕",lightweight:"轻量",customizable:"可定制的",mobile:"移动端",library:"组件库"},"en-US":{barrage:"barrage",play:"play",pause:"pause",videoBarrage:"Imitate video barrage",lightweight:"Lightweight",customizable:"Customizable",mobile:"Mobile",library:"Library"}},components:{PressBarrage:w,PressButton:P},data(){const t=[{id:100,text:this.t("lightweight")},{id:101,text:this.t("customizable")},{id:102,text:this.t("mobile")},{id:103,text:"Vue"},{id:104,text:this.t("library")},{id:105,text:"PressUI"},{id:106,text:"666"}];return{list:t,videoList:[...t],isPlay:!1}},watch:{isPlay:{handler(t){var e,s;t?(e=this.$refs.pressBarrage)==null||e.play():(s=this.$refs.pressBarrage)==null||s.pause()}}},methods:{add(){this.$set(this,"list",[...this.list,{id:Math.random(),text:"Barrage"}])},videoAdd(){this.$set(this,"videoList",[...this.videoList,{id:Math.random(),text:"Barrage"}])},toggle(){this.isPlay=!this.isPlay}}},N={class:"demo-wrap"};function $(t,e,s,a,i,r){const d=p("PressBarrage"),n=p("PressButton"),h=p("demo-block");return c(),b("div",N,[l(h,{title:t.t("basicUsage")},{default:o(()=>[l(d,{modelValue:i.list,"onUpdate:modelValue":e[0]||(e[0]=u=>i.list=u)},{default:o(()=>e[2]||(e[2]=[m("div",{class:"video",style:{width:"100%",height:"150px",background:"#f2f3f5"}},null,-1)])),_:1},8,["modelValue"]),l(n,{type:"primary",size:"small","custom-style":"margin-top: 10px;",onClick:r.add},{default:o(()=>e[3]||(e[3]=[g(" 弹幕 ")])),_:1},8,["onClick"])]),_:1},8,["title"]),l(h,{title:t.t("videoBarrage")},{default:o(()=>[l(d,{ref:"pressBarrage",modelValue:i.videoList,"onUpdate:modelValue":e[1]||(e[1]=u=>i.videoList=u),"auto-play":!1},{default:o(()=>e[4]||(e[4]=[m("div",{class:"video",style:{width:"100%",height:"150px",background:"#f2f3f5"}},null,-1)])),_:1},8,["modelValue"]),m("div",null,[l(n,{type:"primary",size:"small",disabled:!i.isPlay,"custom-style":"margin-top: 10px;margin-right: 10px;",onClick:r.videoAdd},{default:o(()=>e[5]||(e[5]=[g(" 弹幕 ")])),_:1},8,["disabled","onClick"]),l(n,{type:"default",size:"small","custom-style":"margin-top: 10px;",onClick:r.toggle},{default:o(()=>[g(I(i.isPlay?t.t("pause"):t.t("play")),1)]),_:1},8,["onClick"])])]),_:1},8,["title"])])}const z=y(M,[["render",$]]);export{z as default};
