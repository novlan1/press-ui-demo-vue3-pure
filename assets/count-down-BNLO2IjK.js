import{_ as H,o as D,c as S,y as x,a as d,t as u,F as R,u as N,f as o,n as a,r as h}from"./index-BXJiSO9X.js";import{P as B,a as O}from"./press-grid-item-BBRXtFJT.js";import{s as _,a as y}from"./index-D-cODh84.js";import"./utils-Do31p4kb.js";import"./add-unit-Df5pRFBE.js";import"./press-component-DoZYj-_b.js";import"./relation-Cl7c7lz0.js";import"./parent-map-BqFbVUej.js";import"./press-icon-plus-BVVeYod4.js";import"./press-info-CaSyg39j.js";import"./link-Ds6ljOst.js";function m(t,s=2){let i=`${t}`;for(;i.length<s;)i=`0${i}`;return i}const C=1e3,g=60*C,k=60*g,w=24*k;function T(t){const s=Math.floor(t/w),i=Math.floor(t%w/k),l=Math.floor(t%k/g),e=Math.floor(t%g/C),n=Math.floor(t%C);return{days:s,hours:i,minutes:l,seconds:e,milliseconds:n}}function P(t,s){const{days:i}=s;let{hours:l,minutes:e,seconds:n,milliseconds:r}=s;return t.indexOf("DD")===-1?l+=i*24:t=t.replace("DD",m(i)),t.indexOf("HH")===-1?e+=l*60:t=t.replace("HH",m(l)),t.indexOf("mm")===-1?n+=e*60:t=t.replace("mm",m(e)),t.indexOf("ss")===-1?r+=n*1e3:t=t.replace("ss",m(n)),t.replace("SSS",m(r,3))}function b(t,s){return Math.floor(t/1e3)===Math.floor(s/1e3)}function M(t){return setTimeout(t,30)}const v={name:"PressCountDown",props:{useSlot:Boolean,millisecond:Boolean,time:{type:Number,default:0},format:{type:String,default:"HH:mm:ss"},autoStart:{type:Boolean,default:!0}},emits:["change","finish"],data(){return{formattedTime:"0",remain:0}},computed:{timeData(){return T(this.remain)}},watch:{time:{handler(t){const{remain:s,millisecond:i}=this;!i&&(Math.floor(t/1e3)===Math.floor(s/1e3)||Math.round(t/1e3)===Math.round(s/1e3))||this.reset()},immediate:!0}},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},methods:{onDestroyed(){clearTimeout(this.tid),this.tid=null},start(){this.counting||(this.counting=!0,this.endTime=Date.now()+this.remain,this.tick())},pause(){this.counting=!1,clearTimeout(this.tid)},reset(){this.pause(),this.remain=this.time,this.setRemain(this.remain),this.autoStart&&this.start()},tick(){this.millisecond?this.microTick():this.macroTick()},microTick(){this.tid=M(()=>{this.setRemain(this.getRemain()),this.remain!==0&&this.microTick()})},macroTick(){this.tid=M(()=>{const t=this.getRemain();(!b(t,this.remain)||t===0)&&this.setRemain(t),this.remain!==0&&this.macroTick()})},getRemain(){return Math.max(this.endTime-Date.now(),0)},setRemain(t){this.remain=t;const s=T(t);this.useSlot&&this.$emit("change",s),this.formattedTime=P(this.format,s),t===0&&(this.pause(),this.$emit("finish"))}}},I={class:"press-count-down"};function U(t,s,i,l,e,n){return D(),S("div",I,[i.useSlot?x(t.$slots,"default",{key:0,timeData:n.timeData},()=>[d("span",null,u(e.formattedTime),1)],!0):(D(),S(R,{key:1},[N(u(e.formattedTime),1)],64))])}const E=H(v,[["render",U],["__scopeId","data-v-5e6e5273"]]),V={i18n:{"zh-CN":{millisecond:"毫秒级渲染",customStyle:"自定义样式",customFormat:"自定义格式",manualControl:"手动控制",formatWithDay:"DD 天 HH 时 mm 分 ss 秒",reset:"重置",pause:"暂停",start:"开始",finished:"倒计时结束"},"en-US":{millisecond:"Millisecond",customStyle:"Custom Style",customFormat:"Custom Format",manualControl:"Manual Control",formatWithDay:"DD Day, HH:mm:ss",reset:"Reset",pause:"Pause",start:"Start",finished:"Finished"}},components:{PressCountDown:E,PressGrid:B,PressGridItem:O},data(){return{time:30*60*60*1e3,sectionStyle:"margin: 0 12px 20px;"}},methods:{onChange(){},start(){const t=_(this,"#controlCountDown");y(t,null,"start")},pause(){const t=_(this,"#controlCountDown");y(t,null,"pause")},reset(){const t=_(this,"#controlCountDown");y(t,null,"reset")},finished(){}}},W={class:"demo-wrap"},G={class:"item"},z={class:"item"},A={class:"item"};function Y(t,s,i,l,e,n){const r=h("press-count-down"),c=h("demo-block"),p=h("press-grid-item"),F=h("press-grid");return D(),S("div",W,[o(c,{title:t.t("basicUsage"),"section-style":e.sectionStyle},{default:a(()=>[o(r,{time:e.time},null,8,["time"])]),_:1},8,["title","section-style"]),o(c,{title:t.t("customFormat"),"section-style":e.sectionStyle},{default:a(()=>[o(r,{time:e.time,format:t.t("formatWithDay")},null,8,["time","format"])]),_:1},8,["title","section-style"]),o(c,{title:t.t("millisecond"),"section-style":e.sectionStyle},{default:a(()=>[o(r,{time:e.time,millisecond:"",format:"HH:mm:ss:SSS"},null,8,["time"])]),_:1},8,["title","section-style"]),o(c,{title:t.t("customStyle"),"section-style":e.sectionStyle},{default:a(()=>[o(r,{"use-slot":"",time:e.time,onChange:n.onChange},{default:a(({timeData:f})=>[d("span",G,u(f.hours),1),d("span",z,u(f.minutes),1),d("span",A,u(f.seconds),1)]),_:1},8,["time","onChange"])]),_:1},8,["title","section-style"]),o(c,{title:t.t("manualControl"),"section-style":e.sectionStyle},{default:a(()=>[o(r,{id:"controlCountDown",ref:"controlCountDown",millisecond:"",time:3e3,"auto-start":!1,format:"ss:SSS",onFinish:n.finished},null,8,["onFinish"])]),_:1},8,["title","section-style"]),o(F,{clickable:"","column-num":3},{default:a(()=>[o(p,{text:t.t("start"),icon:"play-circle-o",onClick:n.start},null,8,["text","onClick"]),o(p,{text:t.t("pause"),icon:"pause-circle-o",onClick:n.pause},null,8,["text","onClick"]),o(p,{text:t.t("reset"),icon:"replay",onClick:n.reset},null,8,["text","onClick"])]),_:1})])}const st=H(V,[["render",Y],["__scopeId","data-v-ade6297c"]]);export{st as default};
