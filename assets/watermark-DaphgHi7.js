import{_ as f,y as u,c as h,o as d,b as l,B as p,A as w,n as W,t as k,r as c,d as _,h as n,Q as b,e as r,H as P}from"./index-D8fxni52.js";const y={gapX:{type:Number,default:0},gapY:{type:Number,default:0},image:{type:String,default:""},width:{type:Number,default:100},height:{type:Number,default:100},rotate:{type:[Number,String],default:-22},zIndex:{type:[Number,String],default:100},content:{type:String,default:""},opacity:{type:[Number,String],default:1},fullPage:{type:Boolean,default:!1},textColor:{type:String,default:"#dcdee0"}},U=e=>new Promise(s=>{const i=document.createElement("canvas"),o=new Image;o.crossOrigin="anonymous",o.referrerPolicy="no-referrer",o.onload=()=>{i.width=o.naturalWidth,i.height=o.naturalHeight;const a=i.getContext("2d");a==null||a.drawImage(o,0,0),console.log("canvas.width",i.width),console.log("canvas.height",i.height),s(i.toDataURL())},o.src=e}),$=e=>{const s=new Blob([e],{type:"image/svg+xml"});return URL.createObjectURL(s)},B={name:"PressWatermarkWeb",props:{...y},data(){return{imageBase64:"",watermarkUrl:""}},computed:{computedStyle(){return u({backgroundImage:`url(${this.watermarkUrl})`,zIndex:this.zIndex})},rotateStyle(){return u({transformOrigin:"center",transform:`rotate(${this.rotate}deg)`})},svgWidth(){return this.width+this.gapX},svgHeight(){return this.height+this.gapY},imageHtml(){const{imageBase64:e,width:s,height:i,rotateStyle:o}=this;return`<image
          href="${e}"
          xlink:href="${e}"
          x="0"
          y="0"
          width="${s}"
          height="${i}"
          style="${o}"
        />`}},watch:{image:{handler(){U(this.image).then(e=>{this.imageBase64=e})},immediate:!0},imageBase64(){setTimeout(()=>{this.generateWatermarkUrl()})},content:"generateWatermarkUrl",textColor:"generateWatermarkUrl",height:"generateWatermarkUrl",width:"generateWatermarkUrl",rotate:"generateWatermarkUrl",gapX:"generateWatermarkUrl",gapY:"generateWatermarkUrl"},mounted(){console.log("slots",this.$slots),setTimeout(()=>{this.generateWatermarkUrl()})},methods:{styles:u,generateWatermarkUrl(){this.$refs.svgElRef&&(this.revokeWatermarkUrl(),this.watermarkUrl=$(this.$refs.svgElRef.innerHTML))},revokeWatermarkUrl(){this.watermarkUrl&&URL.revokeObjectURL(this.watermarkUrl)}}},R={ref:"svgElRef",class:"press-watermark__wrapper"},S=["viewBox","width","height","innerHTML"],x=["viewBox","width","height"],H=["width","height"];function C(e,s,i,o,a,t){return d(),h("div",{class:W(["press-watermark",{"press-watermark--full":e.fullPage}]),style:p(t.computedStyle)},[l("div",R,[e.image&&!e.$slots.content?(d(),h("svg",{key:0,viewBox:`0 0 ${t.svgWidth} ${t.svgHeight}`,width:t.svgWidth,height:t.svgHeight,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",style:p(t.styles({padding:`0 ${e.gapX}px ${e.gapY}px 0`,opacity:e.opacity})),innerHTML:t.imageHtml},null,12,S)):(d(),h("svg",{key:1,viewBox:`0 0 ${t.svgWidth} ${t.svgHeight}`,width:t.svgWidth,height:t.svgHeight,xmlns:"http://www.w3.org/2000/svg","xmlns:xlink":"http://www.w3.org/1999/xlink",style:p(t.styles({padding:`0 ${e.gapX}px ${e.gapY}px 0`,opacity:e.opacity}))},[(d(),h("foreignObject",{x:"0",y:"0",width:e.width,height:e.height},[l("div",{xmlns:"http://www.w3.org/1999/xhtml",style:p(t.rotateStyle)},[w(e.$slots,"content",{},()=>[l("span",{style:p(`color: ${e.textColor}`)},k(e.content),5)],!0)],4)],8,H))],12,x))],512)],6)}const I=f(B,[["render",C],["__scopeId","data-v-8429e336"]]),T={name:"PressWatermark",components:{PressWatermarkWeb:I},props:{...y,watermark:{type:String,default:""}},data(){return{}},mounted(){},methods:{}};function N(e,s,i,o,a,t){const m=c("PressWatermarkWeb");return d(),_(m,{"gap-x":e.gapX,"gap-y":e.gapY,image:e.image,width:e.width,height:e.height,rotate:e.rotate,"z-index":e.zIndex,content:e.content,opacity:e.opacity,"full-page":e.fullPage,"text-color":e.textColor},{content:n(()=>[w(e.$slots,"content")]),_:3},8,["gap-x","gap-y","image","width","height","rotate","z-index","content","opacity","full-page","text-color"])}const z=f(T,[["render",N]]),L={i18n:{"zh-CN":{switch:"切换",customOpacity:"自定义透明度",customGap:"自定义间隔",customImage:"自定义图片",customRotate:"自定义倾斜角度",displayRange:"显示范围",htmlWatermark:"HTML 水印",textWatermark:"文字水印",imageWatermark:"图片水印"},"en-US":{switch:"Switch",customOpacity:"Custom opacity",customGap:"Custom Gap",customRotate:"Custom Rotate",displayRange:"Display Range",htmlWatermark:"HTML Watermark",textWatermark:"Text Watermark",imageWatermark:"Image Watermark"}},components:{PressWatermark:z,PressButton:b},data(){return{fullPage:!1,image:"https://mike-1255355338.cos.ap-guangzhou.myqcloud.com/press/img/press-ui-full-logo.png",watermark:`<div
              style="background: linear-gradient(45deg, #000 0, #000 50%, #fff 50%);"
            >
              <p style="mix-blend-mode: difference; color: #fff">
                Press watermark
              </p>
            </div>`}},methods:{}},O={class:"demo-wrap"},E={class:"demo-watermark-wrapper"},M={class:"demo-watermark-wrapper"},X={class:"demo-watermark-wrapper"},Y={class:"demo-watermark-wrapper"},G={class:"demo-watermark-wrapper"},j={class:"demo-watermark-wrapper"};function A(e,s,i,o,a,t){const m=c("PressWatermark"),g=c("demo-block"),v=c("PressButton");return d(),h("div",O,[r(g,{title:e.t("textWatermark")},{default:n(()=>[l("div",E,[r(m,{content:"Press","full-page":!1})])]),_:1},8,["title"]),r(g,{title:e.t("imageWatermark")},{default:n(()=>[l("div",M,[r(m,{image:a.image,opacity:"0.2","full-page":!1},null,8,["image"])])]),_:1},8,["title"]),r(g,{title:e.t("customGap")},{default:n(()=>[l("div",X,[r(m,{image:a.image,"gap-x":30,"gap-y":10,opacity:"0.2","full-page":!1},null,8,["image"])])]),_:1},8,["title"]),r(g,{title:e.t("customRotate")},{default:n(()=>[l("div",Y,[r(m,{image:a.image,rotate:"22",opacity:"0.2","full-page":!1},null,8,["image"])])]),_:1},8,["title"]),r(g,{title:e.t("displayRange")},{default:n(()=>[l("div",G,[r(v,{type:"primary",onClick:s[0]||(s[0]=D=>a.fullPage=!a.fullPage)},{default:n(()=>[P(k(e.t("switch")),1)]),_:1}),r(m,{"full-page":a.fullPage,opacity:"0.2",image:a.image},null,8,["full-page","image"])])]),_:1},8,["title"]),r(g,{title:e.t("htmlWatermark")},{default:n(()=>[l("div",j,[r(m,{width:150,"full-page":!1,watermark:a.watermark},{content:n(()=>s[1]||(s[1]=[l("div",{style:{background:"linear-gradient(45deg, #000 0, #000 50%, #fff 50%)"}},[l("p",{style:{"mix-blend-mode":"difference",color:"#fff"}}," Press watermark ")],-1)])),_:1},8,["watermark"])])]),_:1},8,["title"])])}const q=f(L,[["render",A],["__scopeId","data-v-383ca292"]]);export{q as default};
