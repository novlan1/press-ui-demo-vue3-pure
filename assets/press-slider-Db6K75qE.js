import{_ as V,E as v,B as w,al as p,o as l,c as o,a as T,n as u,l as d,w as c,h as m,d as f}from"./index-C8vugXWi.js";import{t as k}from"./touch-Djes3Zvx.js";import{g as y}from"./rect-Djv_hxPF.js";import{a as x}from"./unit-DX-tIsxc.js";const E={name:"PressSlider",mixins:[k],props:{range:Boolean,disabled:Boolean,useButtonSlot:Boolean,activeColor:{type:String,default:""},inactiveColor:{type:String,default:""},max:{type:Number,default:100},min:{type:Number,default:0},step:{type:Number,default:1},value:{type:null,default:0},vertical:{type:Boolean,default:!1},barHeight:{type:[Number,String],default:""},customClass:{type:String,default:""},customStyle:{type:String,default:""}},emits:["drag-start","drag-end","drag","change"],data(){return{utils:v,style:w,barStyle:"",dataValue:this.value}},watch:{value:{handler(e){e!==this.dataValue&&this.updateValue(e)}}},created(){this.updateValue(this.value)},methods:{onTouchStart(e){if(this.disabled)return;const{index:t}=e.currentTarget.dataset;(typeof t=="number"||typeof t=="string")&&(this.buttonIndex=+t),this.touchStart(e),this.startValue=this.format(this.dataValue),this.newValue=this.dataValue,this.isRange(this.newValue)?this.startValue=this.newValue.map(i=>this.format(i)):this.startValue=this.format(this.newValue),this.dragStatus="start"},onTouchMove(e){this.disabled||(this.dragStatus==="start"&&this.$emit("drag-start"),this.touchMove(e),this.dragStatus="draging",y(this,".press-slider").then(t=>{const{vertical:i}=this,r=i?this.deltaY:this.deltaX,n=i?t.height:t.width,s=r/n*this.getRange();this.isRange(this.startValue)?this.newValue[this.buttonIndex]=this.startValue[this.buttonIndex]+s:this.newValue=this.startValue+s,this.updateValue(this.newValue,!1,!0)}))},onTouchEnd(){this.disabled||this.dragStatus==="draging"&&(this.updateValue(this.newValue,!0),this.$emit("drag-end"))},onClick(e){if(this.disabled)return;const{min:t}=this;y(this,".press-slider").then(i=>{const{vertical:r}=this,n=e.touches?e.touches[0]:e,s=r?n.clientY-i.top:n.clientX-i.left,a=r?i.height:i.width,h=Number(t)+s/a*this.getRange();if(this.isRange(this.dataValue)){const[g,b]=this.dataValue,S=(g+b)/2;h<=S?this.updateValue([h,b],!0):this.updateValue([g,h],!0)}else this.updateValue(h,!0)})},isRange(e){const{range:t}=this;return t&&Array.isArray(e)},handleOverlap(e){return e[0]>e[1]?e.slice(0).reverse():e},updateValue(e,t,i){this.isRange(e)?e=this.handleOverlap(e).map(s=>this.format(s)):e=this.format(e),this.dataValue=e;const{vertical:r}=this,n=r?"height":"width";this.wrapperStyle=`
          background: ${this.inactiveColor||""};
          ${r?"width":"height"}: ${x(this.barHeight)||""};
        `,this.barStyle=`
          ${n}: ${this.calcMainAxis()};
          left: ${r?0:this.calcOffset()};
          top: ${r?this.calcOffset():0};
          ${i?"transition: none;":""}
        `,i&&this.$emit("drag",e),t&&this.$emit("change",e),(i||t)&&p()},getScope(){return Number(this.max)-Number(this.min)},getRange(){const{max:e,min:t}=this;return e-t},calcMainAxis(){const{dataValue:e}=this,{min:t}=this,i=this.getScope();return this.isRange(e)?`${(e[1]-e[0])*100/i}%`:`${(e-Number(t))*100/i}%`},calcOffset(){const{dataValue:e}=this,{min:t}=this,i=this.getScope();return this.isRange(e)?`${(e[0]-Number(t))*100/i}%`:"0%"},format(e){const{max:t,min:i,step:r}=this;return Math.round(Math.max(i,Math.min(e,t))/r)*r}}};function M(e,t,i,r,n,s){return l(),o("div",{class:"press-slider-index",style:d(i.customStyle)},[T("div",{class:u(i.customClass+" "+n.utils.bem2("slider",{disabled:i.disabled,vertical:i.vertical})),style:d(e.wrapperStyle),onClick:t[12]||(t[12]=(...a)=>s.onClick&&s.onClick(...a))},[T("div",{class:u([n.utils.bem2("slider__bar")]),style:d(n.barStyle+"; "+n.style({backgroundColor:i.activeColor}))},[i.range?(l(),o("div",{key:0,class:u([n.utils.bem2("slider__button-wrapper-left")]),"data-index":0,onTouchstart:t[0]||(t[0]=(...a)=>s.onTouchStart&&s.onTouchStart(...a)),onTouchmove:t[1]||(t[1]=c((...a)=>s.onTouchMove&&s.onTouchMove(...a),["stop","prevent"])),onTouchend:t[2]||(t[2]=(...a)=>s.onTouchEnd&&s.onTouchEnd(...a)),onTouchcancel:t[3]||(t[3]=(...a)=>s.onTouchEnd&&s.onTouchEnd(...a))},[i.useButtonSlot?m(e.$slots,"left-button",{key:0},void 0,!0):(l(),o("div",{key:1,class:u([n.utils.bem2("slider__button")])},null,2))],34)):f("",!0),i.range?(l(),o("div",{key:1,class:u([n.utils.bem2("slider__button-wrapper-right")]),"data-index":1,onTouchstart:t[4]||(t[4]=(...a)=>s.onTouchStart&&s.onTouchStart(...a)),onTouchmove:t[5]||(t[5]=c((...a)=>s.onTouchMove&&s.onTouchMove(...a),["stop","prevent"])),onTouchend:t[6]||(t[6]=(...a)=>s.onTouchEnd&&s.onTouchEnd(...a)),onTouchcancel:t[7]||(t[7]=(...a)=>s.onTouchEnd&&s.onTouchEnd(...a))},[i.useButtonSlot?m(e.$slots,"right-button",{key:0},void 0,!0):(l(),o("div",{key:1,class:u([n.utils.bem2("slider__button")])},null,2))],34)):f("",!0),i.range?f("",!0):(l(),o("div",{key:2,class:u([n.utils.bem2("slider__button-wrapper")]),onTouchstart:t[8]||(t[8]=(...a)=>s.onTouchStart&&s.onTouchStart(...a)),onTouchmove:t[9]||(t[9]=c((...a)=>s.onTouchMove&&s.onTouchMove(...a),["stop","prevent"])),onTouchend:t[10]||(t[10]=(...a)=>s.onTouchEnd&&s.onTouchEnd(...a)),onTouchcancel:t[11]||(t[11]=(...a)=>s.onTouchEnd&&s.onTouchEnd(...a))},[i.useButtonSlot?m(e.$slots,"button",{key:0},void 0,!0):(l(),o("div",{key:1,class:u([n.utils.bem2("slider__button")])},null,2))],34))],6)],6)],4)}const A=V(E,[["render",M],["__scopeId","data-v-654f21ec"]]);export{A as P};
