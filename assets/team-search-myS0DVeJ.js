import{P as R}from"./press-empty-CARdNJYS.js";import{P as N}from"./press-list-DsMuLbxj.js";import{P as z}from"./press-loading-Cmnq0S8a.js";import{_ as b,r as y,z as K,o as l,c as f,a as h,t as D,d as v,A as C,a5 as G,w as O,y as S,b as B,f as x,n as U,F as q,i as J,v as Q,p as X,e as Y}from"./index-DU6LSpJC.js";import{t as Z}from"./tslib.es6-bc7be52f-C33s8C00.js";import"./press-component-BYCAM0Tw.js";import"./validator-CMi1mmGD.js";import"./press-icon-DQZjI6_I.js";import"./press-loading-plus-BbOWp1Vm.js";import"./utils-Do31p4kb.js";import"./add-unit-Df5pRFBE.js";import"./rect-ZZRvyvMD.js";import"./scroll-DZ_Dh06R.js";import"./system-BAdrsxg_.js";import"./bind-event-CaaqsqMN.js";import"./event-DUjdombs.js";import"./support-passive-CNRHRm4O.js";const $={name:"PressTeamSearch",options:{virtualHost:!0,styleIsolation:"shared"},components:{PressEmpty:R,PressList:N,PressLoading:z},props:{placeholder:{type:String,default:"搜索赛事名称"},customStyle:{type:String,default:""},defaultSearchWords:{type:String,default:""},loading:{type:Boolean,default:!1},loadingText:{type:String,default:"加载中..."},finished:{type:Boolean,default:!1},finishedText:{type:String,default:""},immediateCheck:{type:Boolean,default:!1},teamList:{type:Array,default:()=>[]},showContent:{type:Boolean,default:!0}},emits:["search","blur","focus","clear","clickTeam"],data(){return{inputFocus:!1,searchWords:""}},computed:{innerLoading:{get(){return this.loading},set(t){this.$emit("update:loading",t)}},showFakePlaceholder(){return!this.searchWords&&!this.inputFocus},innerPlaceholder(){return this.showFakePlaceholder?"":this.placeholder}},watch:{defaultSearchWords:{handler(t){t&&(this.searchWords=t)},immediate:!0}},mounted(){},methods:{onBlur(){this.inputFocus=!1,this.$emit("blur",this.searchWords)},onFocus(){this.inputFocus=!0,this.$emit("focus",this.searchWords)},onKeyPress(t){let e=t;return e=e||window.event,(e.which?e.which:e.keyCode)===13&&(this.$refs.searchInput.blur(),this.onSearch()),!0},onSearch(){this.$emit("search",this.searchWords)},clearInput(){this.searchWords="",this.inputFocus=!0,this.$emit("clear")},clickTeam(t){this.$emit("clickTeam",t)},load(){this.$emit("load")}}},A=t=>(X("data-v-f0669ee1"),t=t(),Y(),t),ee={class:"press-search__box"},te={class:"press-search__input-box"},ne=A(()=>h("div",{class:"iconfont icon-search press-search__icon-search"},null,-1)),se={class:"press-search__input-wrap"},re={key:0,class:"press-search__placeholder"},ie=["placeholder"],ae={key:1,class:"press-search__result"},oe=["onClick"],ce={class:"press-search__team-info"},le={key:0,class:"press-search__team-logo",size:"32"},ue=["innerHTML"],de=A(()=>h("div",{class:"iconfont icon-back press-search__icon-back"},null,-1));function he(t,e,n,a,s,r){const d=y("PressLoading"),_=y("PressList"),p=y("PressEmpty"),g=K("lazy");return l(),f("div",{class:"press-search",style:Q(n.customStyle)},[h("div",ee,[h("div",te,[ne,h("div",se,[r.showFakePlaceholder?(l(),f("div",re,D(n.placeholder),1)):v("",!0),C(h("input",{ref:"searchInput","onUpdate:modelValue":e[0]||(e[0]=i=>s.searchWords=i),class:"press-search__input","placeholder-style":"color: #c2c4c9;",placeholder:r.innerPlaceholder,"confirm-type":"search",focus:!1,onKeypress:e[1]||(e[1]=(...i)=>r.onKeyPress&&r.onKeyPress(...i)),onBlur:e[2]||(e[2]=(...i)=>r.onBlur&&r.onBlur(...i)),onFocus:e[3]||(e[3]=(...i)=>r.onFocus&&r.onFocus(...i)),onConfirm:e[4]||(e[4]=(...i)=>r.onSearch&&r.onSearch(...i))},null,40,ie),[[G,s.searchWords]])]),s.searchWords?(l(),f("div",{key:0,class:"iconfont icon-clear press-search__icon-clear",onClick:e[5]||(e[5]=O((...i)=>r.clearInput&&r.clearInput(...i),["stop"]))})):v("",!0)]),h("div",{class:"press-search__confirm",onClick:e[6]||(e[6]=(...i)=>r.onSearch&&r.onSearch(...i))}," 搜索 ")]),n.showContent?S(t.$slots,"content",{key:0},()=>[n.loading&&!n.teamList.length?(l(),B(d,{key:0})):n.teamList.length?(l(),f("div",ae,[x(_,{modelValue:r.innerLoading,"onUpdate:modelValue":e[7]||(e[7]=i=>r.innerLoading=i),finished:n.finished,"immediate-check":n.immediateCheck,"loading-text":n.loadingText,"finished-text":n.finishedText,onLoad:r.load},{default:U(()=>[(l(!0),f(q,null,J(n.teamList,i=>(l(),f("div",{key:i.team_id,class:"press-search__team",onClick:L=>r.clickTeam(i)},[h("div",ce,[i.team_logo?C((l(),f("img",le,null,512)),[[g,i.team_logo]]):v("",!0),h("div",{class:"press-search__team-name press-ellipsis",innerHTML:i.teamNameHtml},null,8,ue)]),de],8,oe))),128))]),_:1},8,["modelValue","finished","immediate-check","loading-text","finished-text","onLoad"])])):n.teamList.length?v("",!0):(l(),B(p,{key:2,type:"e-sport",description:"暂无数据","custom-style":"height: 100%;"}))],!0):v("",!0),S(t.$slots,"other",{},void 0,!0)],4)}const me=b($,[["render",he],["__scopeId","data-v-f0669ee1"]]);function fe(t="",e="",n="#1181d7"){if(!e)return t;const a=e.replace(/([|+*?[\](){}^$|])/g,"\\$1");return t.replace(new RegExp(`(${a}+)`,"g"),(r,d)=>`<span style="color: ${n};">${d}</span>`)}var u={},c={},o=Z,T=6e3;function k(t,e,n){return n===void 0&&(n=T),o.__awaiter(this,void 0,void 0,function(){var a;return o.__generator(this,function(s){switch(s.label){case 0:return s.trys.push([0,2,,3]),[4,e.waitForSelector(t,{timeout:n})];case 1:return a=s.sent(),[3,3];case 2:return s.sent(),[3,3];case 3:return[2,a]}})})}function w(t){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){switch(e.label){case 0:return t?[4,t.evaluate(function(n){return n.click()})]:[3,2];case 1:return e.sent(),[2,!0];case 2:return[2,!1]}})})}function F(t,e,n){return n===void 0&&(n=T),o.__awaiter(this,void 0,void 0,function(){var a;return o.__generator(this,function(s){switch(s.label){case 0:return[4,k(t,e,n)];case 1:return a=s.sent(),[4,w(a)];case 2:return s.sent(),[2,a]}})})}function I(t){return new Promise(function(e){return setTimeout(e,t)})}function W(t){return o.__awaiter(this,void 0,void 0,function(){var e,n,a;return o.__generator(this,function(s){switch(s.label){case 0:return e="about:blank",[4,t.waitForTarget(function(r){return r.url()===e},{timeout:T})];case 1:return n=s.sent(),n?[4,n.page()]:[2];case 2:return a=s.sent(),a?(a.close(),[2]):[2]}})})}function H(t,e){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(n){switch(n.label){case 0:return typeof t!="string"?[3,2]:[4,k(t,e)];case 1:t=n.sent(),n.label=2;case 2:return[4,e.evaluate(function(a){var s=a.getBoundingClientRect(),r=s.top,d=s.left,_=s.bottom,p=s.right,g=s.x,i=s.y,L=s.width,j=s.height;return{top:r,left:d,bottom:_,right:p,x:g,y:i,width:L,height:j}},t)];case 3:return[2,n.sent()]}})})}function E(t,e){return o.__awaiter(this,void 0,void 0,function(){var n,a;return o.__generator(this,function(s){switch(s.label){case 0:return[4,k(t,e)];case 1:return n=s.sent(),n?[4,e.evaluate(function(r){return r.innerText},n)]:[2,null];case 2:return a=s.sent(),[2,a]}})})}function M(t){var e=t.page,n=t.element,a=t.innerText;return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(s){switch(s.label){case 0:return[4,e.evaluate(function(r){var d=r.element,_=r.innerText,p=document.querySelectorAll(d),g=Array.from(p).find(function(i){return i.innerText===_});g&&g.click()},{element:n,innerText:a})];case 1:return s.sent(),[2]}})})}function V(t){return o.__awaiter(this,void 0,void 0,function(){return o.__generator(this,function(e){return[2,t.evaluate(function(){return location.href})]})})}var _e=Object.freeze({__proto__:null,waitEle:k,clickBtn:w,findAndClick:F,justWait:I,closeBlankPage:W,getRect:H,getInnerText:E,findListItemAndClick:M,getHref:V});c.clickBtn=w;c.closeBlankPage=W;c.element=_e;c.findAndClick=F;c.findListItemAndClick=M;c.getHref=V;c.getInnerText=E;c.getRect=H;c.justWait=I;c.waitEle=k;Object.defineProperty(u,"__esModule",{value:!0});var m=c;u.clickBtn=m.clickBtn;u.closeBlankPage=m.closeBlankPage;u.findAndClick=m.findAndClick;u.findListItemAndClick=m.findListItemAndClick;u.getHref=m.getHref;u.getInnerText=m.getInnerText;u.getRect=m.getRect;var ge=u.justWait=m.justWait;u.waitEle=m.waitEle;const pe=Array.from({length:200}).map((t,e)=>{const n=`${e}_team_vue+_press_ui_vue?++_vue*_components_uni-app`;return{team_name:e%5===0?n.slice(0,10):n,team_id:e,team_logo:"https://image-1251917893.file.myqcloud.com/Esports/user/img/default-avatar.png"}});async function P(t,e){const a=pe.filter(s=>s.team_name.indexOf(e)>-1).slice(t*20,(t+1)*20).map(s=>({...s,teamNameHtml:fe(s.team_name,e)}));return await ge(600-t*100),{teamList:a,finished:!a.length}}const ve={components:{PressTeamSearch:me},data(){return{teamList:[],loading:!1,finished:!1,searchValue:"",defaultSearchWords:"123",loadTime:0}},mounted(){this.onSearch(this.defaultSearchWords)},methods:{async onSearch(t){console.log("[search]",t),this.searchValue=t,this.teamList=[],this.loadTime=0,this.loading=!0;const{teamList:e,finished:n}=await P(this.loadTime,t);this.teamList=e,this.finished=n,this.loading=!1},onClickTeam(t){console.log("[clickTeam]",t),this.onGTip(`[clickTeam] ${t.team_id}`)},onClear(){this.onGTip("[clear]"),console.log("[clear]"),this.searchValue=""},onFocus(){this.onGTip("[focus]"),console.log("[focus]")},onBlur(){this.onGTip("[blur]"),console.log("[blur]")},async onLoadMore(){console.log("[onLoadMore]"),this.loadTime+=1;const{teamList:t,finished:e}=await P(this.loadTime,this.searchValue);this.finished=e,this.teamList=this.teamList.concat(t),this.loading=!1}}},ke={class:"demo-wrap"};function ye(t,e,n,a,s,r){const d=y("PressTeamSearch");return l(),f("div",ke,[x(d,{"team-list":s.teamList,loading:s.loading,finished:s.finished,"default-search-words":s.defaultSearchWords,onLoad:r.onLoadMore,"onUpdate:loading":e[0]||(e[0]=_=>s.loading=_),onSearch:r.onSearch,onClickTeam:r.onClickTeam,onClear:r.onClear,onFocus:r.onFocus,onBlur:r.onBlur},null,8,["team-list","loading","finished","default-search-words","onLoad","onSearch","onClickTeam","onClear","onFocus","onBlur"])])}const je=b(ve,[["render",ye],["__scopeId","data-v-4d087f8a"]]);export{je as default};
