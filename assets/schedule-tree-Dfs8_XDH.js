import{S as N,f as I}from"./sche-list-CRLBYh2Q.js";import{M as S,G as n,l as k,s as y,b as p}from"./custom-BMf98uHI.js";import{P as O}from"./press-popup-cell-BRvFaCLg.js";import{P as D}from"./press-picker-DbBH-6ty.js";import{P as R}from"./press-cell-CpEJn8Fu.js";import{_ as U,C as M,o as C,c as v,f as d,n as G,b as F,d as V,r as _}from"./index-DU6LSpJC.js";import"./press-loading-plus-BbOWp1Vm.js";import"./utils-Do31p4kb.js";import"./add-unit-Df5pRFBE.js";import"./press-component-BYCAM0Tw.js";import"./validator-CMi1mmGD.js";import"./index-CHC6BFDw.js";import"./scroll-DZ_Dh06R.js";import"./time-DadpJyRx.js";import"./status-helper-BDbpegZd.js";import"./press-popup-BD9wiulf.js";import"./press-button-CU9PqmxY.js";import"./press-icon-plus-B9pxPV2T.js";import"./press-info-Cexnh41C.js";import"./press-loading-Cmnq0S8a.js";import"./button-BaKXjqxg.js";import"./system-BAdrsxg_.js";import"./function-DQ-N3A6u.js";import"./press-switch-O4hJM1tR.js";import"./computed-DUQ6cINf.js";import"./functional-CczSRz4G.js";import"./rect-ZZRvyvMD.js";import"./link-Ds6ljOst.js";import"./event-DUjdombs.js";import"./support-passive-CNRHRm4O.js";const{DEFAULT_NAME:B,DEFAULT_AVATAR:K}=S,h={score:0,teamid:"PREVIEW",teamname:B,fromBracketDesc:"xxx",teamavatar:K},L={gid:331,sch_type:4,sch_rule:{round_stage:101,round_type:"main",round_id:2,group_id:1,tree_node_uni_id:"10014655_101_main_2_1_0"},sch_score:{teama_id:"PREVIEW",teamb_id:"PREVIEW"},sch_dantao:{},childid:10014655,status:"未开始"},T={site_id:10014653,child_id:10014655,gid:331,round_stage:101,round_type:"main",round_id:1,round_name:"2进1",bo_type:1,grp_num:1,grp_source_num:4,grp_promote_num:2,source_num:4,promote_num:2,start_battle_type:1,ready_time_utime:1686100386},f={bracketIdDesc:"U1",battleid:"",gameName:"杨的比赛",roundName:"2进1",boType:1,curBo:1,roomType:1,battleStatus:"未开始",redSide:"",status:"未开始",isWeChatLiving:!1,liveInfo:{}},H=[[{battleList:[{...f,realStatus:100,teamList:[h,h],nodeItem:{...L,sch_dantao:{both_team_set:3}}},{...f,teamList:[h,h],nodeItem:{...L,sch_dantao:{both_team_set:3}}}],roundInfo:{...T,round_name:"4进2"},isChamp:!1}],[{battleList:[{...f,realStatus:100,teamList:[h,h],nodeItem:{...L}}],roundInfo:{...T,round_name:"2进1"},isChamp:!0}]],Y={scheList:H},b=[{start_battle_type:1},{start_battle_type:2},{start_battle_type:3,show_stime:1686100386},{start_battle_type:1,ready_time_utime:1686100386},{start_battle_type:2,ready_time_utime:1686100386},{start_battle_type:3,show_stime:1686100386,ready_time_utime:1686100386}];function P(e=""){return{score:0,teamid:`team-id-${e}`,teamname:S.DEFAULT_NAME,fromBracketDesc:"U16胜者",teamavatar:S.DEFAULT_AVATAR}}function A(e={},o=""){let t={...(e==null?void 0:e.nodeItem)||{},utime:1686100386};return e.abnormalErr&&(t={...t,sch_score:{...t.sch_score||{},err_flag:9999}}),{nodeItem:t,...e,schid:o,teamList:[P(`${o}-a`),P(`${o}-b`)]}}function g({info:e,roundIndex:o=0,teamIndex:t=0,scheGroupNumber:c=2,groupType:s,teamNumber:r}){const m=[A(e,`${t}-a`)],i=E(r,s);return c===2&&m.push(A(e,`${t}-b`)),{battleList:m,roundInfo:{...b[o%b.length],round_name:W({minusRoundNumber:o+1,roundNumber:i-o,groupType:s})}}}function W({roundNumber:e,groupType:o,minusRoundNumber:t}){return o===n.KNOCK_OUT.name?t-1===0?"决赛":`${2**t}进${2**(t-1)}`:o===n.CYCLE.name?`第${e}轮`:o===n.DOUBLE_FAIL_LOSER.name?`败者组第${e}轮`:""}function E(e,o){const t=Math.log(e)/Math.log(2);return o!==n.DOUBLE_FAIL_LOSER.name?t:2*t}function J({info:e,teamNumber:o,groupType:t}){const c=E(o,t),{scheList:s}=Y;return t===n.CYCLE.name?Array.from({length:c}).map((a,l)=>Array.from({length:10}).map((u,w)=>g({info:e,scheGroupNumber:1,roundIndex:l,teamIndex:l*10+w,groupType:t,teamNumber:o}))).reverse():t===n.DOUBLE_FAIL_LOSER.name?Array.from({length:c}).map((i,a)=>a?a===1?[{...s[1][0],roundInfo:{...s[1][0].roundInfo||{},round_name:`败者组第${c-1}轮`}}]:Array.from({length:2**Math.floor((a-2)/2)}).map((l,u)=>g({info:e,scheGroupNumber:2,roundIndex:a,teamIndex:a*1e3+u,groupType:t,teamNumber:o})):[{...s[1][0],roundInfo:{...s[1][0].roundInfo||{},round_name:`败者组第${c}轮`}}]).reverse():Array.from({length:c}).map((m,i)=>i?i===1?s[0]:Array.from({length:2**(i-1)}).map((a,l)=>g({info:e,scheGroupNumber:2,roundIndex:i,teamIndex:i*100+l,groupType:t,teamNumber:o})):s[1]).reverse()}const z={i18n:{"zh-CN":{custom:"自定义"},"en-US":{custom:"Custom"}},components:{ScheduleTree:N,PressPopupCell:O,PressPicker:D,PressCell:R},data(){return{sectionStyle:"margin: 0;background: #f7f8fa;",headerStyle:"background: #f7f8fa;",FUNCTIONAL_ID_MAP:M,myTeamId:"team-id-515-b-a",scheList:[],isPreview:0,scheLocal:{...k}}},computed:{finished(){return this.scheLocal.teamNumber==4&&this.shadow},loading(){return this.scheLocal.teamNumber==2&&this.shadow},showChampion(){return this.scheLocal.groupType!==n.CYCLE.name},shadow(){return this.scheLocal.groupType===n.CYCLE.name}},mounted(){this.generateData()},methods:{onScroll(e,o){this.onGTip(`[scroll] ${e} ${o}`)},scrollToLower(e,o){const t=`[scrollToLower] ${e} ${o}`;this.onGTip(t),console.log(t)},onShowBasicPopupCell(){y({context:this,callback:{changeTeamNumber:this.changeTeamNumber,changeStatus:this.changeStatus,changeAdmin:this.changeAdmin,changeGroupType:this.changeGroupType,changeErrorTip:this.changeErrorTip}})},changeTeamNumber(e){this.scheLocal.teamNumber=e,this.generateData()},changeStatus(e){this.scheLocal.status=e,this.generateData(),this.isPreview=p[e].isPreview||0},changeAdmin(e){this.scheLocal={...this.scheLocal,isAdmin:e},this.generateData()},changeErrorTip(e){var o,t;this.scheLocal={...this.scheLocal,showError:e},this.generateData(),(t=(o=this.$refs)==null?void 0:o.pressScheduleTreeRef)==null||t.scrollToOneSche("511-a")},changeGroupType(e){this.scheLocal={...this.scheLocal,groupType:e},this.generateData()},generateData(){const{isAdmin:e,teamNumber:o,status:t,groupType:c,showError:s}=this.scheLocal,r=J({info:{...p[t],abnormalErr:!!s},teamNumber:o,groupType:c});console.log("[Origin ScheList]",JSON.stringify(r)),this.scheList=I({scheList:r,isPreview:p[t].isPreview||0,isAdmin:e}),console.log("[Parsed ScheList]",JSON.stringify(this.scheList))},clickRoundTab(e){console.log("[clickRoundTab]",...e),this.onGTip("click round tab")},clickSche(e,o,t){console.log("[clickSche]",e,o,t),this.onGTip("click schedule item")},clickVideoIcon(e,o,t){console.log("[clickVideoIcon]",e,o,t),this.onGTip("click video icon")}}},j={class:"demo-wrap demo-wrap--gray demo-wrap--flex"};function q(e,o,t,c,s,r){const m=_("press-cell"),i=_("demo-block"),a=_("ScheduleTree",!0),l=_("PressPopupCell"),u=_("PressPicker");return C(),v("div",j,[d(i,{title:e.t("basicUsage"),"section-style":s.sectionStyle,"header-style":s.headerStyle},{default:G(()=>[d(m,{title:e.t("custom"),"is-link":"",onClick:r.onShowBasicPopupCell},null,8,["title","onClick"])]),_:1},8,["title","section-style","header-style"]),s.scheList.length?(C(),F(a,{key:0,ref:"pressScheduleTreeRef","sche-list":s.scheList,"is-admin":s.scheLocal.isAdmin,"is-preview":s.isPreview,"show-champion":r.showChampion,shadow:r.shadow,"auto-back-to-top":r.showChampion,"my-team-id":s.myTeamId,"max-columns":6,loading:r.loading,finished:r.finished,"finished-text":"-- 已经拉到底了 --",onClickRoundTab:r.clickRoundTab,onClickSche:r.clickSche,onClickVideoIcon:r.clickVideoIcon,onScroll:r.onScroll,onScrollToLower:r.scrollToLower},null,8,["sche-list","is-admin","is-preview","show-champion","shadow","auto-back-to-top","my-team-id","loading","finished","onClickRoundTab","onClickSche","onClickVideoIcon","onScroll","onScrollToLower"])):V("",!0),d(l,{id:s.FUNCTIONAL_ID_MAP.POPUP_CELL,ref:s.FUNCTIONAL_ID_MAP.POPUP_CELL,mode:"functional"},null,8,["id"]),d(u,{id:s.FUNCTIONAL_ID_MAP.PICKER,ref:s.FUNCTIONAL_ID_MAP.PICKER,mode:"functional"},null,8,["id"])])}const Ee=U(z,[["render",q],["__scopeId","data-v-171c498b"]]);export{Ee as default};
