import{_ as D,o as l,c as u,h as S,a as k,t as d,F as M,G as g}from"./index-88cP1sOH.js";function a(t,e=2){let s=`${t}`;for(;s.length<e;)s=`0${s}`;return s}const r=1e3,c=60*r,h=60*c,f=24*h;function p(t){const e=Math.floor(t/f),s=Math.floor(t%f/h),o=Math.floor(t%h/c),i=Math.floor(t%c/r),n=Math.floor(t%r);return{days:e,hours:s,minutes:o,seconds:i,milliseconds:n}}function y(t,e){const{days:s}=e;let{hours:o,minutes:i,seconds:n,milliseconds:m}=e;return t.indexOf("DD")===-1?o+=s*24:t=t.replace("DD",a(s)),t.indexOf("HH")===-1?i+=o*60:t=t.replace("HH",a(o)),t.indexOf("mm")===-1?n+=i*60:t=t.replace("mm",a(i)),t.indexOf("ss")===-1?m+=n*1e3:t=t.replace("ss",a(n)),t.replace("SSS",a(m,3))}function _(t,e){return Math.floor(t/1e3)===Math.floor(e/1e3)}function T(t){return setTimeout(t,30)}const x={name:"PressCountDown",props:{useSlot:Boolean,millisecond:Boolean,time:{type:Number,default:0},format:{type:String,default:"HH:mm:ss"},autoStart:{type:Boolean,default:!0}},emits:["change","finish"],data(){return{formattedTime:"0",remain:0}},computed:{timeData(){return p(this.remain)}},watch:{time:{handler(t){const{remain:e,millisecond:s}=this;!s&&(Math.floor(t/1e3)===Math.floor(e/1e3)||Math.round(t/1e3)===Math.round(e/1e3))||this.reset()},immediate:!0}},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},methods:{onDestroyed(){clearTimeout(this.tid),this.tid=null},start(){this.counting||(this.counting=!0,this.endTime=Date.now()+this.remain,this.tick())},pause(){this.counting=!1,clearTimeout(this.tid)},reset(){this.pause(),this.remain=this.time,this.setRemain(this.remain),this.autoStart&&this.start()},tick(){this.millisecond?this.microTick():this.macroTick()},microTick(){this.tid=T(()=>{this.setRemain(this.getRemain()),this.remain!==0&&this.microTick()})},macroTick(){this.tid=T(()=>{const t=this.getRemain();(!_(t,this.remain)||t===0)&&this.setRemain(t),this.remain!==0&&this.macroTick()})},getRemain(){return Math.max(this.endTime-Date.now(),0)},setRemain(t){this.remain=t;const e=p(t);this.useSlot&&this.$emit("change",e),this.formattedTime=y(this.format,e),t===0&&(this.pause(),this.$emit("finish"))}}},R={class:"press-count-down"};function w(t,e,s,o,i,n){return l(),u("div",R,[s.useSlot?S(t.$slots,"default",{key:0,timeData:n.timeData},()=>[k("span",null,d(i.formattedTime),1)],!0):(l(),u(M,{key:1},[g(d(i.formattedTime),1)],64))])}const B=D(x,[["render",w],["__scopeId","data-v-5e6e5273"]]);export{B as P};
