import{a as p}from"./add-unit-B8Dm0KXN.js";import{s as S}from"./style-CpIyAjCl.js";import{_ as f,o as c,c as m,i as g,m as _,t as V,f as e,l as i,r as h,a as T}from"./index-BOnk8Yuo.js";import{P as b,a as C}from"./press-grid-item-BekX0_Gg.js";import"./press-component-D9D_j5DA.js";import"./relation-Ce8eT7mn.js";import"./parent-map-_1jD1UtF.js";import"./press-icon-plus-C7Qb4xCs.js";import"./press-info-C1OldtTD.js";import"./utils-C2tViYFs.js";import"./link-BfUqlCTp.js";const N={props:{startValue:{type:[String,Number],default:0},endValue:{type:[String,Number],default:0},duration:{type:[String,Number],default:2e3},autoplay:{type:Boolean,default:!0},decimals:{type:[String,Number],default:0},useEasing:{type:Boolean,default:!0},decimal:{type:[String,Number],default:"."},color:{type:String,default:"#606266"},fontSize:{type:[String,Number],default:22},bold:{type:Boolean,default:!1},separator:{type:String,default:","},customStyle:{type:String,default:""},useSlot:{type:Boolean,default:!1}}},F={name:"PressCountTo",options:{virtualHost:!0,styleIsolation:"shared"},mixins:[N],emits:["change","end"],data(){return{localStartVal:this.startValue,displayValue:this.formatNumber(this.startValue),printVal:null,paused:!1,localDuration:Number(this.duration),startTime:null,timestamp:null,remaining:null,rAF:null,lastTime:0}},computed:{countToStyle(){const{customStyle:t,fontSize:a,bold:s,color:l}=this;return`${t} ${S({fontSize:p(a),fontWeight:s?"bold":"normal",color:l})}}`},countDown(){return this.startValue>this.endValue}},watch:{startValue(){this.autoplay&&this.start()},endValue(){this.autoplay&&this.start()}},mounted(){this.autoplay&&this.start()},methods:{addUnit:p,easingFn(t,a,s,l){return s*(-Math.pow(2,-10*t/l)+1)*1024/1023+a},requestAnimationFrame(t){const a=new Date().getTime(),s=Math.max(0,16-(a-this.lastTime)),l=setTimeout(()=>{t(a+s)},s);return this.lastTime=a+s,l},cancelAnimationFrame(t){clearTimeout(t)},start(){this.localStartVal=this.startValue,this.startTime=null,this.localDuration=this.duration,this.paused=!1,this.rAF=this.requestAnimationFrame(this.count)},reStart(){this.paused?(this.resume(),this.paused=!1):(this.stop(),this.paused=!0)},stop(){this.cancelAnimationFrame(this.rAF)},resume(){this.remaining&&(this.startTime=0,this.localDuration=this.remaining,this.localStartVal=this.printVal,this.requestAnimationFrame(this.count))},reset(){this.startTime=null,this.cancelAnimationFrame(this.rAF),this.displayValue=this.formatNumber(this.startValue),this.$emit("change",this.displayValue)},count(t){this.startTime||(this.startTime=t),this.timestamp=t;const a=t-this.startTime;this.remaining=this.localDuration-a,this.useEasing?this.countDown?this.printVal=this.localStartVal-this.easingFn(a,0,this.localStartVal-this.endValue,this.localDuration):this.printVal=this.easingFn(a,this.localStartVal,this.endValue-this.localStartVal,this.localDuration):this.countDown?this.printVal=this.localStartVal-(this.localStartVal-this.endValue)*(a/this.localDuration):this.printVal=this.localStartVal+(this.endValue-this.localStartVal)*(a/this.localDuration),this.countDown?this.printVal=this.printVal<this.endValue?this.endValue:this.printVal:this.printVal=this.printVal>this.endValue?this.endValue:this.printVal,this.displayValue=this.formatNumber(this.printVal)||0,this.$emit("change",this.displayValue),a<this.localDuration?this.rAF=this.requestAnimationFrame(this.count):this.$emit("end")},isNumber(t){return!isNaN(parseFloat(t))},formatNumber(t){t=Number(t),t=t.toFixed(Number(this.decimals)),t+="";const a=t.split(".");let s=a[0];const l=a.length>1?this.decimal+a[1]:"",u=/(\d+)(\d{3})/;if(this.separator&&!this.isNumber(this.separator))for(;u.test(s);)s=s.replace(u,`$1${this.separator}$2`);return s+l},destroyed(){this.cancelAnimationFrame(this.rAF)}}},v={class:"press-count-to"};function D(t,a,s,l,u,o){return c(),m("span",v,[t.useSlot?g(t.$slots,"default",{key:0},void 0,!0):(c(),m("span",{key:1,class:"press-count-to__number",style:_(o.countToStyle)},V(u.displayValue),5))])}const A=f(F,[["render",D],["__scopeId","data-v-2bffc895"]]),w={i18n:{"zh-CN":{customStyle:"自定义样式",decimals:"小数位",separator:"千分位分隔符",duration:"自定义持续时间",animation:"禁用缓慢动画",control:"自定义控制",resume:"继续",pause:"暂停",start:"开始",countdown:"倒计时",slot:"插槽"},"en-US":{customStyle:"Custom Style",decimals:"Decimal",separator:"Separator",duration:"Duration",animation:"Animation",control:"Control",resume:"Resume",pause:"Pause",start:"Start",countdown:"Countdown",slot:"Slot"}},components:{PressCountTo:A,PressGrid:b,PressGridItem:C},data(){return{customStyle:"margin-right: 16px;",autoplay:!1,slotValue:""}},methods:{start(){this.$refs.pressCountToRef.start()},pause(){this.$refs.pressCountToRef.stop()},resume(){this.$refs.pressCountToRef.resume()},onEnd(){this.onGTip("[end]")},onChange(t){this.slotValue=t}}},k={class:"demo-wrap"},E={style:{color:"red"}};function $(t,a,s,l,u,o){const n=h("PressCountTo"),r=h("demo-block"),d=h("press-grid-item"),y=h("press-grid");return c(),m("div",k,[e(r,{title:t.t("basicUsage")},{default:i(()=>[e(n,{"start-value":30,"end-value":500,onEnd:o.onEnd},null,8,["onEnd"])]),_:1},8,["title"]),e(r,{title:t.t("customStyle")},{default:i(()=>[e(n,{"end-value":3e3,color:"#909399","font-size":30,bold:!0})]),_:1},8,["title"]),e(r,{title:t.t("duration")},{default:i(()=>[e(n,{"start-value":30,"end-value":500,duration:5e3,onEnd:o.onEnd},null,8,["onEnd"])]),_:1},8,["title"]),e(r,{title:t.t("animation")},{default:i(()=>[e(n,{"start-value":30,"end-value":500,"use-easing":!1})]),_:1},8,["title"]),e(r,{title:t.t("countdown")},{default:i(()=>[e(n,{"start-value":500,"end-value":0})]),_:1},8,["title"]),e(r,{title:t.t("decimals")},{default:i(()=>[e(n,{"start-value":30,"end-value":500,decimals:2,decimal:1})]),_:1},8,["title"]),e(r,{title:t.t("separator")},{default:i(()=>[e(n,{"end-value":5e3,separator:","})]),_:1},8,["title"]),e(r,{title:t.t("slot")},{default:i(()=>[e(n,{"end-value":5e3,"use-slot":!0,onChange:o.onChange},{default:i(()=>[T("span",E,V(u.slotValue),1)]),_:1},8,["onChange"])]),_:1},8,["title"]),e(r,{title:t.t("control")},{default:i(()=>[e(n,{ref:"pressCountToRef","end-value":5e3,autoplay:u.autoplay,onEnd:o.onEnd},null,8,["autoplay","onEnd"])]),_:1},8,["title"]),e(y,{clickable:"","column-num":3},{default:i(()=>[e(d,{text:t.t("start"),icon:"play-circle-o",onClick:o.start},null,8,["text","onClick"]),e(d,{text:t.t("pause"),icon:"pause-circle-o",onClick:o.pause},null,8,["text","onClick"]),e(d,{text:t.t("resume"),icon:"replay",onClick:o.resume},null,8,["text","onClick"])]),_:1})])}const W=f(w,[["render",$]]);export{W as default};
