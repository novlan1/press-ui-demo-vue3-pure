import{C as _,_ as w,v as I,A as S,x as B,G as P,Q as N,r as v,c as m,o as a,a as y,m as g,n as i,d as h,l as f,b as C,H as D,t as x,F as W,e as T}from"./index-saBp3IWc.js";import{g as X}from"./event-DXUYgFmE.js";import{r as b}from"./system-DS1pCZJ5.js";import{g as p}from"./rect--gogr3iH.js";function V(t){return _({color:t.color,"background-color":t.backgroundColor,background:t.background})}const A={rootStyle:V};function F({contentSelect:t=".press-notice-bar__content",wrapSelector:n=".press-notice-bar__wrap",context:e,speed:l=60,scrollable:r=!0}){return new Promise((s,o)=>{b(()=>{Promise.all([p(e,t),p(e,n)]).then(c=>{const[u,d]=c;if(u==null||d==null||!u.width||!d.width||r===!1){o();return}if(r||d.width<u.width){const k=(d.width+u.width)/l*1e3;s({wrapWidth:d.width,contentWidth:u.width,duration:k})}}).catch(c=>{o(c)})})})}const R={name:"PressNoticeBar",options:{...B,styleIsolation:"shared"},components:{PressIconPlus:S},props:{text:{type:String,default:""},mode:{type:String,default:""},url:{type:String,default:""},openType:{type:String,default:"navigate"},delay:{type:Number,default:1},speed:{type:Number,default:60},scrollable:{type:Boolean,default:!1},leftIcon:{type:String,default:""},color:{type:String,default:""},backgroundColor:{type:String,default:""},background:{type:String,default:""},wrapable:Boolean,...I},emits:["close","click"],data(){return{show:!0,duration:0,animationDuration:0,contentWidth:0,translateX:0,isNotInUni:N()}},computed:{noticeBarClass(){const{mode:t,wrapable:n,customClass:e}=this;return`${e} ${P.bem2("notice-bar",{withicon:t,wrapable:n})}`},noticeBarStyle(){const{color:t,backgroundColor:n,background:e}=this;return A.rootStyle({color:t,backgroundColor:n,background:e})},animationStyle(){const{animationDuration:t,delay:n,translateX:e}=this;return[`transform: translateX(${e}px);`,`transition: -webkit-transform ${t}ms linear ${n}ms, transform ${t}ms linear ${n}ms;`,"transform-origin: 50% 50% 0px;"].join(" ")},leftIconClass(){return"press-notice-bar__left-icon"},leftIconCustomClass(){return""},rightIconClass(){return"press-notice-bar__right-icon"},rightIconCustomClass(){return""}},watch:{text:{handler(){this.init()}},speed:{handler(){this.init()}}},created(){},mounted(){this.init()},destroyed(){this.onDestroyed()},unmounted(){this.onDestroyed()},methods:{onDestroyed(){this.timer&&clearTimeout(this.timer)},init(){const{speed:t,scrollable:n}=this;F({contentSelect:".press-notice-bar__content",wrapSelector:".press-notice-bar__wrap",context:this,speed:t,scrollable:n}).then(({wrapWidth:e,contentWidth:l,duration:r})=>{this.wrapWidth=e,this.contentWidth=l,this.duration=r,this.scroll(!0)}).catch(()=>{})},scroll(t=!1){this.timer&&clearTimeout(this.timer),this.timer=null,this.translateX=t?0:this.wrapWidth,this.animationDuration=0,b(()=>{this.translateX=-this.contentWidth,this.animationDuration=this.duration}),this.timer=setTimeout(()=>{this.scroll()},this.duration)},onClickIcon(t){this.mode==="closeable"&&(this.timer&&clearTimeout(this.timer),this.timer=null,this.show=!1,this.$emit("close",X(t)))},onClick(t){this.$emit("click",t)}}},U={class:"press-notice-bar-index"},z={class:"press-notice-bar__wrap"},E=["url","open-type"];function q(t,n,e,l,r,s){const o=v("PressIconPlus");return a(),m("div",U,[r.show?(a(),m("div",{key:0,class:i(s.noticeBarClass),style:g(s.noticeBarStyle),onClick:n[0]||(n[0]=(...c)=>s.onClick&&s.onClick(...c))},[e.leftIcon?(a(),h(o,{key:0,name:e.leftIcon,class:i([s.leftIconClass]),"custom-class":s.leftIconCustomClass},null,8,["name","class","custom-class"])):f(t.$slots,"left-icon",{key:1},void 0,!0),C("div",z,[C("div",{class:i("press-notice-bar__content "+(e.scrollable===!1&&!e.wrapable?"press-ellipsis":"")),style:g(s.animationStyle)},[D(x(e.text)+" ",1),e.text?y("",!0):f(t.$slots,"default",{key:0},void 0,!0)],6)]),e.mode==="closeable"?(a(),h(o,{key:2,class:i([s.rightIconClass]),"custom-class":s.rightIconCustomClass,name:"cross",onClick:s.onClickIcon},null,8,["class","custom-class","onClick"])):e.mode==="link"?(a(),m(W,{key:3},[r.isNotInUni?(a(),h(o,{key:0,class:i([s.rightIconClass]),"custom-class":s.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])):(a(),m("navigator",{key:1,url:e.url,"open-type":e.openType},[T(o,{class:i([s.rightIconClass]),"custom-class":s.rightIconCustomClass,name:"arrow"},null,8,["class","custom-class"])],8,E))],64)):f(t.$slots,"right-icon",{key:4},void 0,!0)],6)):y("",!0)])}const j=w(R,[["render",q],["__scopeId","data-v-bfff0bc9"]]);export{j as P};
