import{v as A,x as E,E as g,R as C,_ as V,o,c as d,a as S,h as u,d as c,n as a,l as m,B as T,af as R,ag as x,r as k,e as I,k as N,F as P,q as L,G as W,t as O,b as _}from"./index-CVvyLI3I.js";import{C as H,P as M}from"./relation-Ce8eT7mn.js";import{d as y}from"./parent-map-12wGqNaT.js";import{r as w,g as X}from"./system-C9_hz2I0.js";import{P as j}from"./press-sticky-Bpy_eCsy.js";import{t as F}from"./touch-Djes3Zvx.js";import{c as B,g as z}from"./rect-DCTdZwuf.js";import{S as U}from"./scroll-view-B7JHfIU0.js";const q={name:"PressTab",mixins:[H(y)],options:{...A,styleIsolation:"shared"},props:{...E,dot:{type:Boolean,default:!1},info:{type:[String,Number,null],default:""},title:{type:[String,Number,null],default:""},disabled:{type:Boolean,default:!1},titleStyle:{type:String,default:""},name:{type:[String,Number,null],default:""},extraClassPrefix:{type:String,default:""},sortIndex:{type:Number,default:0}},emits:[],data(){return{active:!1,shouldShow:!1,shouldRender:!1,initialled:!1,utils:g}},computed:{tabClass(){const{active:e,customClass:t=""}=this;return`${this.bem3("tab__pane",{active:e,inactive:!e})} ${t}`}},watch:{dot:{handler(){this.update()}},info:{handler(){this.update()}},title:{handler(){this.update()}},disabled:{handler(){this.update()}},titleStyle:{handler(){this.update()}}},created(){},mounted(){this.update()},methods:{bem3(e,t){return g.bem3(e,t,this.extraClassPrefix)},getComputedName(){return this.name!==""?this.name:this.index},updateRender(e,t){this.initialled=this.initialled||e,this.active=e,this.shouldRender=this.initialled||!t.lazyRender,this.shouldShow=e||t.animated},update(){this[y]&&(this[y].updateTabs(),w(()=>{this[y].resize()}))},destroyCallback(){this[y].updateTabs(),C(()=>{this[y].resize()})}}};function K(e,t,l,n,i,s){return o(),d("div",{class:a([s.bem3("tab__pane-wrapper")])},[S("div",{class:a(s.tabClass),style:m(i.shouldShow?"":"display: none;")},[i.shouldRender?u(e.$slots,"default",{key:0}):c("",!0)],6)],2)}const ue=V(q,[["render",K]]);function G(e,t){const l=["tab-class"];return e&&l.push("tab-active-class"),t&&l.push("press-ellipsis"),l.join(" ")}function J(e){const t=e.active?e.titleActiveColor:e.titleInactiveColor,l=e.scrollable&&e.ellipsis;return e.type==="card"?T({"border-color":e.color,"background-color":!e.disabled&&e.active?e.color:null,color:t||(!e.disabled&&!e.active?e.color:null),"flex-basis":l?`${88/e.swipeThreshold}%`:null}):T({color:t,"flex-basis":l?`${88/e.swipeThreshold}%`:null})}function Q(e,t){return T({"border-color":t==="card"&&e?e:null})}function Y(e){return e.animated?T({left:`${-100*e.currentIndex}%`,"transition-duration":`${e.duration}s`,"-webkit-transition-duration":`${e.duration}s`}):""}function Z(e){const t=g.addUnit(e.lineWidth);return T({width:t,transform:`translateX(${e.lineOffsetLeft}px)`,"-webkit-transform":`translateX(${e.lineOffsetLeft}px)`,"background-color":e.color,height:e.lineHeight!==-1?g.addUnit(e.lineHeight):null,"border-radius":e.lineHeight!==-1?g.addUnit(e.lineHeight):null,"transition-duration":e.skipTransition?null:`${e.duration}s`,"-webkit-transition-duration":e.skipTransition?null:`${e.duration}s`})}const v={tabClass:G,tabStyle:J,trackStyle:Y,lineStyle:Z,navStyle:Q},$={name:"PressTabs",options:{...A,styleIsolation:"shared"},components:{PressInfo:R,PressSticky:j},mixins:[F,M(y),U],props:{...E,navClass:{type:String,default:""},tabClass:{type:String,default:""},tabActiveClass:{type:String,default:""},lineClass:{type:String,default:""},sticky:{type:Boolean,default:!1},border:{type:Boolean,default:!1},swipeable:{type:Boolean,default:!1},titleActiveColor:{type:String,default:""},titleInactiveColor:{type:String,default:""},color:{type:String,default:""},animated:{type:Boolean,default:!1},lineWidth:{type:[Number,String,null],default:40},lineHeight:{type:[Number,String,null],default:-1},active:{type:[Number,String,null],default:0},type:{type:String,default:"line"},ellipsis:{type:Boolean,default:!0},duration:{type:Number,default:.3},zIndex:{type:Number,default:1},swipeThreshold:{type:Number,default:5},offsetTop:{type:Number,default:0},lazyRender:{type:Boolean,default:!0},extraClassPrefix:{type:String,default:""},mode:{type:String,default:""},useTitleSlot:{type:Boolean,default:!1},scrollViewProps:{type:Object,default:()=>({upperThreshold:50,lowerThreshold:50})}},emits:["scroll","disabled","click","input","change","scrolltoupper","scrolltolower","scrollViewScroll"],data(){return{tabs:[],scrollLeft:0,scrollable:!1,currentIndex:0,container:null,skipTransition:!0,scrollWithAnimation:!1,lineOffsetLeft:0,computed:v,utils:g}},computed:{tabsClass(){const{type:e,customClass:t,mode:l}=this,n=l==="hor",i=l==="e-sport";return`${this.bem3("tabs",[e,{hor:n,"e-sport":i}])} ${t}`},tabsWrapClass(){const{scrollable:e,type:t,border:l}=this;return`${this.bem3("tabs__wrap",{scrollable:e})} ${t==="line"&&l?this.bem3("hairline--top-bottom"):""}`},tabScrollClass(){const{type:e}=this;return this.bem3("tabs__scroll",[e])},theNavClass(){const{type:e,ellipsis:t,navClass:l}=this,n=`${l} nav-class`;return`${this.bem3("tabs__nav",[e,{complete:!t}])} ${n}`},navStyle(){const{color:e,type:t}=this;return v.navStyle(e,t)},lineStyle(){const{color:e,lineOffsetLeft:t,lineHeight:l,skipTransition:n,duration:i,lineWidth:s}=this;return v.lineStyle({color:e,lineOffsetLeft:t,lineHeight:l,skipTransition:n,duration:i,lineWidth:s})},trackClass(){const{animated:e}=this;return`${this.bem3("tabs__track",[{animated:e}])}`},trackStyle(){const{duration:e,currentIndex:t,animated:l}=this;return v.trackStyle({duration:e,currentIndex:t,animated:l})},realEllipsis(){return this.scrollable&&this.ellipsis}},watch:{animated:{handler(){this.children.forEach((e,t)=>e.updateRender(t===this.currentIndex,this))}},lineWidth:{handler(){this.resize()}},active:{handler(e){e!==this.getCurrentName()&&this.setCurrentIndexByName(e)}},swipeThreshold:{handler(e){this.setData({scrollable:this.children.length>e||!this.ellipsis})}}},created(){this.children=[]},mounted(){w(()=>{this.swiping=!0,this.container=()=>this.$refs.pressTabs,this.updateTabs(),this.resize(),this.scrollIntoView()}),C(()=>{this.resize()})},methods:{bem3(e,t){return g.bem3(e,t,this.extraClassPrefix)},getTabClass(e,t){const{currentIndex:l,ellipsis:n,tabClass:i,tabActiveClass:s}=this,h=`${s} tab-active-class`,f=`${i} tab-class`;return`${this.bem3("tab",{active:t===l,disabled:e.disabled||!1,complete:!n})} ${this.bem3("ellipsis")} ${f} ${t===l?h:""}`},getSlotTabClass(e){return this.getTabClass(this.tabs[e]||{},e)},getTabStyle(e,t){const{type:l,color:n,active:i,currentIndex:s,realEllipsis:h,titleActiveColor:f,titleInactiveColor:b,swipeThreshold:r}=this,p=h?`${88/r}%`:null;return l==="card"?T({borderColor:n,backgroundColor:!e.disabled&&i?n:null,color:(t===s?f:b)||(!e.disabled&&!i?n:null),flexBasis:p}):T({color:t===s?f:b,flexBasis:p})},setData(e){Object.keys(e).forEach(t=>{this[t]=e[t]})},updateTabs(){const{children:e=[]}=this;this.tabs=e.map(t=>({title:t.title,index:t.index,disabled:t.disabled,info:t.info,dot:t.dot,titleStyle:t.titleStyle})),this.scrollable=e.length>this.swipeThreshold||!this.ellipsis,this.setCurrentIndexByName(this.active||this.getCurrentName())},trigger(e,t){const{currentIndex:l}=this,n=t||this.children[l];x(n)&&this.$emit(e,{index:n.index,name:n.getComputedName(),title:n.title})},onTap(e){const t=+e.currentTarget.dataset.index,l=this.children[t];l.disabled?this.trigger("disabled",l):(this.setCurrentIndex(t),C(()=>{this.trigger("click")}))},setCurrentIndexByName(e){const{children:t=[]}=this,l=t.filter(n=>n.getComputedName()===e);l.length&&this.setCurrentIndex(l[0].index)},setCurrentIndex(e){const{children:t=[]}=this;if(!x(e)||e>=t.length||e<0||(X(this,()=>{t.forEach((n,i)=>{const s=i===e;(s!==n.active||!n.initialled)&&n.updateRender(s,this)})}),e===this.currentIndex))return;const l=this.currentIndex!==null;this.setData({currentIndex:e}),w(()=>{this.resize(),this.scrollIntoView()}),C(()=>{this.trigger("input"),l&&this.trigger("change")})},getCurrentName(){const e=this.children[this.currentIndex];if(e)return e.getComputedName()},resize(){if(this.type!=="line")return;const{currentIndex:e,ellipsis:t,skipTransition:l}=this;Promise.all([B(this,".press-tab"),z(this,".press-tabs__line")]).then(([n=[],i])=>{const s=n[e];if(s==null)return;let h=n.slice(0,e).reduce((f,b)=>f+b.width,0);h+=(s.width-i.width)/2+(t?0:8),this.setData({lineOffsetLeft:h}),this.swiping=!0,l&&C(()=>{this.setData({skipTransition:!1})})}).catch(n=>{console.log("err",n)})},scrollIntoView(){const{currentIndex:e,scrollable:t,scrollWithAnimation:l}=this;t&&Promise.all([B(this,".press-tab"),z(this,".press-tabs__nav")]).then(([n,i])=>{const s=n[e],h=n.slice(0,e).reduce((f,b)=>f+b.width,0);this.setData({scrollLeft:h-(i.width-s.width)/2}),l||C(()=>{this.setData({scrollWithAnimation:!0})})}).catch(n=>{console.log("error",n)})},onTouchScroll(e){this.$emit("scroll",e)},onTouchStart(e){this.swipeable&&(this.swiping=!0,this.touchStart(e))},onTouchMove(e){!this.swipeable||!this.swiping||this.touchMove(e)},onTouchEnd(){if(!this.swipeable||!this.swiping)return;const{direction:e,deltaX:t,offsetX:l}=this;if(e==="horizontal"&&l>=50){const i=this.getAvailableTab(t);i!==-1&&this.setCurrentIndex(i)}this.swiping=!1},getAvailableTab(e){const{tabs:t,currentIndex:l}=this,n=e>0?-1:1;for(let i=n;l+i<t.length&&l+i>=0;i+=n){const s=l+i;if(s>=0&&s<t.length&&t[s]&&!t[s].disabled)return s}return-1},getTabKey(e,t){return`${e.title||""} - ${t} -${e.index}`},scrolltoupper(e){this.$emit("scrolltoupper",e)},scrolltolower(e){this.$emit("scrolltolower",e)},scrollViewScroll(e){this.$emit("scrollViewScroll",e)}}},ee=["data-index"];function te(e,t,l,n,i,s){const h=k("PressInfo"),f=k("scroll-view"),b=k("PressSticky");return o(),d("div",{ref:"pressTabs",class:a(s.tabsClass)},[I(b,{disabled:!l.sticky,"z-index":l.zIndex,"offset-top":l.offsetTop,container:i.container,onScroll:s.onTouchScroll},{default:N(()=>[S("div",{class:a(s.tabsWrapClass)},[u(e.$slots,"nav-left",{},void 0,!0),I(f,{"scroll-x":i.scrollable,"scroll-with-animation":i.scrollWithAnimation,"scroll-left":i.scrollLeft,class:a(s.tabScrollClass),style:m(l.color?"border-color: "+l.color:""),"upper-threshold":l.scrollViewProps.upperThreshold,"lower-threshold":l.scrollViewProps.lowerThreshold,onScrolltoupper:s.scrolltoupper,onScrolltolower:s.scrolltolower,onScroll:s.scrollViewScroll},{default:N(()=>[S("div",{class:a(s.theNavClass),style:m(s.navStyle)},[l.type==="line"?(o(),d("div",{key:0,class:a([`${s.bem3("tabs__line")} ${l.lineClass}`]),style:m(s.lineStyle)},null,6)):c("",!0),l.useTitleSlot?(o(),d(P,{key:1},[i.tabs.length>0?(o(),d("div",{key:0,class:a([`${s.getSlotTabClass(0)}`]),"data-index":0,onClick:t[0]||(t[0]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-0",{},void 0,!0)],2)):c("",!0),i.tabs.length>1?(o(),d("div",{key:1,class:a([`${s.getSlotTabClass(1)}`]),"data-index":1,onClick:t[1]||(t[1]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-1",{},void 0,!0)],2)):c("",!0),i.tabs.length>2?(o(),d("div",{key:2,class:a([`${s.getSlotTabClass(2)}`]),"data-index":2,onClick:t[2]||(t[2]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-2",{},void 0,!0)],2)):c("",!0),i.tabs.length>3?(o(),d("div",{key:3,class:a([`${s.getSlotTabClass(3)}`]),"data-index":3,onClick:t[3]||(t[3]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-3",{},void 0,!0)],2)):c("",!0),i.tabs.length>4?(o(),d("div",{key:4,class:a([`${s.getSlotTabClass(4)}`]),"data-index":4,onClick:t[4]||(t[4]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-4",{},void 0,!0)],2)):c("",!0),i.tabs.length>5?(o(),d("div",{key:5,class:a([`${s.getSlotTabClass(5)}`]),"data-index":5,onClick:t[5]||(t[5]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-5",{},void 0,!0)],2)):c("",!0),i.tabs.length>6?(o(),d("div",{key:6,class:a([`${s.getSlotTabClass(6)}`]),"data-index":6,onClick:t[6]||(t[6]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-6",{},void 0,!0)],2)):c("",!0),i.tabs.length>7?(o(),d("div",{key:7,class:a([`${s.getSlotTabClass(7)}`]),"data-index":7,onClick:t[7]||(t[7]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-7",{},void 0,!0)],2)):c("",!0),i.tabs.length>8?(o(),d("div",{key:8,class:a([`${s.getSlotTabClass(8)}`]),"data-index":8,onClick:t[8]||(t[8]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-8",{},void 0,!0)],2)):c("",!0),i.tabs.length>9?(o(),d("div",{key:9,class:a([`${s.getSlotTabClass(9)}`]),"data-index":9,onClick:t[9]||(t[9]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-9",{},void 0,!0)],2)):c("",!0),i.tabs.length>10?(o(),d("div",{key:10,class:a([`${s.getSlotTabClass(10)}`]),"data-index":10,onClick:t[10]||(t[10]=(...r)=>s.onTap&&s.onTap(...r))},[u(e.$slots,"title-10",{},void 0,!0)],2)):c("",!0)],64)):(o(!0),d(P,{key:2},L(i.tabs,(r,p)=>(o(),d("div",{key:s.getTabKey(r,p),"data-index":p,class:a([`${s.getTabClass(r,p)}`]),style:m([`${s.getTabStyle(r,p)}`]),onClick:t[11]||(t[11]=(...D)=>s.onTap&&s.onTap(...D))},[S("div",{class:a([`${s.bem3("tab__text")}`,l.ellipsis?"press-ellipsis":""]),style:m(r.titleStyle)},[W(O(r.title)+" ",1),r.info!==null||r.dot?(o(),_(h,{key:0,info:r.info,dot:r.dot,"custom-class":"press-tab__title__info"},null,8,["info","dot"])):c("",!0)],6)],14,ee))),128))],6)]),_:3},8,["scroll-x","scroll-with-animation","scroll-left","class","style","upper-threshold","lower-threshold","onScrolltoupper","onScrolltolower","onScroll"]),u(e.$slots,"nav-right",{},void 0,!0)],2)]),_:3},8,["disabled","z-index","offset-top","container","onScroll"]),S("div",{class:a([`${s.bem3("tabs__content")}`]),onTouchstart:t[12]||(t[12]=(...r)=>s.onTouchStart&&s.onTouchStart(...r)),onTouchmove:t[13]||(t[13]=(...r)=>s.onTouchMove&&s.onTouchMove(...r)),onTouchend:t[14]||(t[14]=(...r)=>s.onTouchEnd&&s.onTouchEnd(...r)),onTouchcancel:t[15]||(t[15]=(...r)=>s.onTouchEnd&&s.onTouchEnd(...r))},[S("div",{class:a(s.trackClass),style:m(s.trackStyle)},[u(e.$slots,"default",{},void 0,!0)],6)],34)],2)}const ce=V($,[["render",te],["__scopeId","data-v-f6b4d2ec"]]);export{ue as P,ce as a};
